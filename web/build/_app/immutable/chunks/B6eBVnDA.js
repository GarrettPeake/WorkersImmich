const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_app/immutable/chunks/7ZR7F41Y.js","_app/immutable/chunks/DsnmJJEf.js","_app/immutable/chunks/C8vxa4mj.js","_app/immutable/chunks/D0CSSuTl.js","_app/immutable/chunks/DIeogL5L.js","_app/immutable/chunks/Bd1JH_Ov.js","_app/immutable/chunks/D8NIUdeB.js","_app/immutable/chunks/orVkzVhB.js","_app/immutable/chunks/DLePdI2u.js","_app/immutable/chunks/BP6NvnZ7.js","_app/immutable/chunks/7tRQeUtl.js","_app/immutable/chunks/zonMEKN6.js","_app/immutable/chunks/D-UYCH9y.js","_app/immutable/chunks/CMI33r64.js","_app/immutable/chunks/gvLJu3l0.js","_app/immutable/chunks/BUApaBEI.js","_app/immutable/assets/Logo.REF6zmWd.css","_app/immutable/chunks/IOA7-Wrn.js","_app/immutable/chunks/dsDpGkcL.js","_app/immutable/chunks/BRztk81V.js","_app/immutable/chunks/0qPXRVhz.js","_app/immutable/chunks/DUXNbmIP.js","_app/immutable/chunks/DxRnQWdm.js","_app/immutable/chunks/CG4KAGH3.js","_app/immutable/chunks/BpCm29KX.js","_app/immutable/chunks/gegweU97.js","_app/immutable/chunks/DWQ0JXRY.js","_app/immutable/chunks/CJGyQpNN.js","_app/immutable/chunks/BVZhy_zG.js","_app/immutable/chunks/CIJfCxLq.js","_app/immutable/chunks/C_T4m_n1.js","_app/immutable/chunks/B2VKg7zy.js","_app/immutable/chunks/DcdhlkRn.js","_app/immutable/chunks/Q3VoKRsI.js","_app/immutable/chunks/DU5vAHPb.js","_app/immutable/chunks/DFvk55M8.js","_app/immutable/chunks/B9MV_P2E.js","_app/immutable/chunks/CwqKZNgJ.js","_app/immutable/chunks/DPMzVlQx.js","_app/immutable/chunks/CS-10t6W.js","_app/immutable/chunks/DW5CvR3c.js","_app/immutable/chunks/BHTYC334.js","_app/immutable/chunks/Tw41aoDi.js","_app/immutable/chunks/Bqqp8sy9.js","_app/immutable/chunks/CF_nq223.js","_app/immutable/chunks/WQ1yKytR.js","_app/immutable/chunks/DnqqNi3p.js","_app/immutable/chunks/oXVv5nIS.js","_app/immutable/chunks/ChL-L15l.js","_app/immutable/chunks/CoqJY867.js","_app/immutable/chunks/DS0yfrVF.js","_app/immutable/chunks/3Su-ePg-.js","_app/immutable/chunks/s_2UW97Q.js","_app/immutable/assets/Input.idyGuON4.css","_app/immutable/chunks/69_IOA4Y.js","_app/immutable/chunks/9chJ2bcr.js","_app/immutable/chunks/B8RZOa0L.js","_app/immutable/chunks/Dgf_MdoC.js","_app/immutable/chunks/BZ21-Ulh.js","_app/immutable/chunks/5Inb98wy.js","_app/immutable/chunks/FpAj0Eak.js","_app/immutable/chunks/BjFPDMuz.js","_app/immutable/chunks/msCV69PI.js","_app/immutable/chunks/CgXU4mBI.js","_app/immutable/chunks/D1613R3V.js","_app/immutable/chunks/Biw8UfMB.js","_app/immutable/chunks/BMcevgEe.js","_app/immutable/chunks/BgQCgJ0_.js","_app/immutable/chunks/BzOEcAd-.js","_app/immutable/chunks/i7F918yQ.js","_app/immutable/chunks/CLpfTz4o.js","_app/immutable/chunks/Cr9S0fVn.js","_app/immutable/chunks/BmJQ54Se.js","_app/immutable/chunks/D3D47pl8.js","_app/immutable/chunks/BOLL51yO.js","_app/immutable/chunks/GXf5CvES.js","_app/immutable/chunks/BitKOkE8.js","_app/immutable/chunks/jZIyHVjf.js","_app/immutable/chunks/CG2BHJh0.js","_app/immutable/chunks/DKzKigBY.js","_app/immutable/chunks/Cq6696VF.js","_app/immutable/chunks/C3VE5xEq.js","_app/immutable/chunks/BcI9YXFA.js","_app/immutable/assets/Textarea.CRksyXnO.css","_app/immutable/assets/activity-viewer.CwxlvmcY.css","_app/immutable/chunks/CbJ1QVsO.js","_app/immutable/assets/thumbnail.Di7rqjOL.css","_app/immutable/chunks/BVcN3VUI.js","_app/immutable/chunks/C0GZEybY.js","_app/immutable/chunks/DCmy867i.js","_app/immutable/chunks/CC3fx6b-.js","_app/immutable/chunks/BCf5NZQ6.js","_app/immutable/chunks/DxfhPdFw.js","_app/immutable/chunks/D5KKc-uL.js","_app/immutable/chunks/BbpJDI0d.js","_app/immutable/chunks/GyRE5G4-.js","_app/immutable/chunks/DDy4N4G7.js","_app/immutable/chunks/XSsqx5Lk.js","_app/immutable/chunks/Dt4pkAJO.js","_app/immutable/assets/asset-viewer.CSooJwqO.css"])))=>i.map(i=>d[i]);
import{_ as Xe,A as N}from"./0qPXRVhz.js";import"./DsnmJJEf.js";import{p as Ye,V as b,g as t,$ as I,f as p,s as se,a as Ze,u as c,h as P,j as k,t as L,c as oe,r as G}from"./D0CSSuTl.js";import{e as M,s as $e}from"./C8vxa4mj.js";import{a as g,c as K,f as T}from"./Bd1JH_Ov.js";import{a as et}from"./Biw8UfMB.js";import{i as C}from"./D8NIUdeB.js";import{e as tt,h as st}from"./DLePdI2u.js";import{p as l,a as D,s as ot,e as nt}from"./zonMEKN6.js";import{a as at}from"./IOA7-Wrn.js";import{ac as ne}from"./D-UYCH9y.js";import{g as ae}from"./gvLJu3l0.js";import{s as rt}from"./BVZhy_zG.js";import{T as it}from"./CbJ1QVsO.js";import{P as ct,m as re}from"./BRztk81V.js";import{f as lt}from"./oXVv5nIS.js";import{A as dt,d as ut}from"./ChL-L15l.js";import{S as ft}from"./BEqGsB-Y.js";import{R as ie}from"./gegweU97.js";import{a as ce}from"./Cr9S0fVn.js";import{n as j,h as le,j as ht,k as mt,e as gt,o as vt,s as At}from"./DUXNbmIP.js";import{g as wt}from"./MMtgDOP-.js";import{b as It}from"./DxRnQWdm.js";import{t as z,i as St}from"./CF_nq223.js";import{n as de}from"./BP6NvnZ7.js";import{$ as _t}from"./DWQ0JXRY.js";import{d as yt}from"./Dts20Tr4.js";import{m as ue}from"./BHTYC334.js";var xt=T('<div class="absolute text-center p-1 text-xs font-mono font-semibold w-full bottom-0 bg-linear-to-t bg-slate-50/75 dark:bg-slate-800/75 overflow-clip text-ellipsis whitespace-pre-wrap"> </div>'),bt=T('<div class="absolute"><!> <!></div>'),pt=T("<div></div>"),kt=T("<!> <!>",1);function ts(fe,s){Ye(s,!0);const he=()=>D(At,"$showDeleteModal",S),J=()=>D(xe,"$isViewerOpen",S),me=()=>D(_t,"$t",S),H=()=>D(be,"$viewingAsset",S),[S,ge]=ot();let n=l(s,"assets",15),ve=l(s,"disableAssetSelect",3,!1),Ae=l(s,"showArchiveIcon",3,!1),we=l(s,"onIntersected",3,void 0),Ie=l(s,"showAssetName",3,!1),Se=l(s,"onReload",3,void 0),U=l(s,"slidingWindowOffset",3,0),_e=l(s,"pageHeaderOffset",3,0),ye=l(s,"arrowNavigation",3,!0),{isViewing:xe,asset:be}=ce;const d=c(()=>wt(n(),{spacing:2,heightTolerance:.5,rowHeight:Math.floor(s.viewport.width)<850?100:235,rowWidth:Math.floor(s.viewport.width)})),pe=e=>{const o=t(d);return`top: ${o.getTop(e)}px; left: ${o.getLeft(e)}px; width: ${o.getWidth(e)}px; height: ${o.getHeight(e)}px;`},ke=e=>{const o=t(d),a=t(B),r=o.getTop(e);return r+_e()<a.bottom&&r+o.getHeight(e)>a.top};let v=P(!1),_=P(null),q=P(0),B=c(()=>{const e=(t(q)||0)-U(),o=e+s.viewport.height+U();return{top:e,bottom:o}});const Me=e=>{const o=n().findIndex(a=>a.id===e.id);n(n()[o]=e,!0)},Ce=()=>k(q,document.scrollingElement?.scrollTop??0,!0),De=yt(()=>we()?.(),750,{maxWait:100,leading:!0});let Q=0;b(()=>{if(t(d).containerHeight-t(B).bottom<=s.viewport.height){const e=t(d).containerHeight;Q!==e&&(De(),Q=e)}});const Te=()=>{s.assetInteraction.selectAssets(n().map(e=>z(e)))},E=()=>{gt(s.assetInteraction)},He=e=>{e.key==="Shift"&&(e.preventDefault(),k(v,!0))},Ee=e=>{e.key==="Shift"&&(e.preventDefault(),k(v,!1))},X=e=>{if(!e)return;const o=s.assetInteraction.hasSelectedAsset(e.id);if(o){for(const a of s.assetInteraction.assetSelectionCandidates)s.assetInteraction.removeAssetFromMultiselectGroup(a.id);s.assetInteraction.removeAssetFromMultiselectGroup(e.id)}else{for(const a of s.assetInteraction.assetSelectionCandidates)s.assetInteraction.selectAsset(a);s.assetInteraction.selectAsset(e)}s.assetInteraction.clearAssetSelectionCandidates(),s.assetInteraction.setAssetSelectionStart(o?null:e)},Oe=e=>{e&&Y(e),k(_,e,!0)},Y=e=>{if(!t(v))return;const o=s.assetInteraction.assetSelectionStart;if(!o)return;let a=n().findIndex(i=>i.id===o.id),r=n().findIndex(i=>i.id===e.id);a>r&&([a,r]=[r,a]),s.assetInteraction.setAssetSelectionCandidates(n().slice(a,r+1).map(i=>z(i)))},Ve=e=>{s.assetInteraction.selectionActive&&t(v)&&e.preventDefault()},Re=()=>{const e=s.assetInteraction.selectedAssets.some(o=>o.isTrashed);le(Z(e))},Z=async(e=!1)=>{const o=e||!lt.value.trash,a=s.assetInteraction.selectedAssets;he()&&o&&!await ue.show(dt,{size:a.length})||(await ut(o,r=>n(n().filter(i=>!r.includes(i.id))),a,Se()),s.assetInteraction.clearMultiselect())},We=async()=>{const e=await vt(s.assetInteraction.selectedAssets,s.assetInteraction.isAllArchived?de.Timeline:de.Archive);e&&(n(n().filter(o=>!e.includes(o.id))),E())},Fe=()=>re(e=>e.dataset.thumbnailFocusContainer!==void 0,"next"),Ne=()=>re(e=>e.dataset.thumbnailFocusContainer!==void 0,"previous");let O=!1;const Pe=async()=>{O||(O=!0,await ue.show(ft,{}),O=!1)},Le=c(()=>(()=>{if(J())return[];const e=[{shortcut:{key:"?",shift:!0},onShortcut:Pe},{shortcut:{key:"/"},onShortcut:()=>ae(ie.explore())},{shortcut:{key:"A",ctrl:!0},onShortcut:()=>Te()},...ye()?[{shortcut:{key:"ArrowRight"},preventDefault:!1,onShortcut:Fe},{shortcut:{key:"ArrowLeft"},preventDefault:!1,onShortcut:Ne}]:[]];return s.assetInteraction.selectionActive&&e.push({shortcut:{key:"Escape"},onShortcut:E},{shortcut:{key:"Delete"},onShortcut:Re},{shortcut:{key:"Delete",shift:!0},onShortcut:()=>Z(!0)},{shortcut:{key:"D",ctrl:!0},onShortcut:()=>E()},{shortcut:{key:"a",shift:!0},onShortcut:We}),e})()),Ge=async()=>{if(n().length!==0)try{const e=Math.floor(Math.random()*n().length),o=n()[e];return await j(o),o}catch(e){st(e,me()("errors.cannot_navigate_next_asset"));return}},Ke=async e=>{switch(e.type){case N.ARCHIVE:case N.DELETE:case N.TRASH:{const o=t(V).nextAsset??t(V).previousAsset;if(n().splice(n().findIndex(a=>a.id===e.asset.id),1),n().length===0)return await ae(ie.photos());o&&await j(o);break}}},je=e=>{s.assetInteraction.selectionActive&&Oe(e)};b(()=>{t(_)||s.assetInteraction.clearAssetSelectionCandidates()}),b(()=>{t(v)||s.assetInteraction.clearAssetSelectionCandidates()}),b(()=>{t(v)&&t(_)&&Y(t(_))});const V=c(()=>({current:H(),nextAsset:mt(n(),H()),previousAsset:ht(n(),H())}));var $=kt();M("keydown",I,He),M("keyup",I,Ee),M("selectstart",I,Ve),at(I,(e,o)=>rt?.(e,o),()=>t(Le)),M("scroll",I,()=>Ce());var ee=p($);{var ze=e=>{var o=pt();let a;tt(o,23,n,(r,i)=>r.id+"-"+i,(r,i,u)=>{var y=K(),R=p(y);{var W=A=>{const f=c(()=>z(t(i)));var h=bt();let x;var te=oe(h);{let m=c(()=>s.assetInteraction.hasSelectedAsset(t(f).id)),w=c(()=>s.assetInteraction.hasSelectionCandidate(t(f).id)),F=c(()=>t(d).getWidth(t(u))),Qe=c(()=>t(d).getHeight(t(u)));it(te,{get readonly(){return ve()},onClick:()=>{if(s.assetInteraction.selectionActive){X(t(f));return}j(t(i))},onSelect:()=>X(t(f)),onMouseEvent:()=>je(t(f)),get showArchiveIcon(){return Ae()},get asset(){return t(f)},get selected(){return t(m)},get selectionCandidate(){return t(w)},get thumbnailWidth(){return t(F)},get thumbnailHeight(){return t(Qe)}})}var qe=se(te,2);{var Be=m=>{var w=xt(),F=oe(w,!0);G(w),L(()=>$e(F,t(i).originalFileName)),g(m,w)};C(qe,m=>{Ie()&&!St(t(i))&&m(Be)})}G(h),L(m=>x=ne(h,m,x,{overflow:"clip"}),[()=>pe(t(u))]),g(A,h)};C(R,A=>{ke(t(u))&&A(W)})}g(r,y)}),G(o),L(()=>a=ne(o,"",a,{position:"relative",height:t(d).containerHeight+"px",width:t(d).containerWidth+"px"})),g(e,o)};C(ee,e=>{n().length>0&&e(ze)})}var Je=se(ee,2);{var Ue=e=>{ct(e,{target:"body",children:(o,a)=>{var r=K(),i=p(r);et(i,()=>Xe(()=>import("./7ZR7F41Y.js").then(u=>u.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99])),null,(u,y)=>{var R=c(()=>{var{default:h}=t(y);return{AssetViewer:h}}),W=c(()=>t(R).AssetViewer),A=K(),f=p(A);nt(f,()=>t(W),(h,x)=>{x(h,{get cursor(){return t(V)},onAction:Ke,onRandom:Ge,onAssetChange:Me,onClose:()=>{ce.showAssetViewer(!1),le(It({targetRoute:"current",assetId:null}))}})}),g(u,A)}),g(o,r)},$$slots:{default:!0}})};C(Je,e=>{J()&&e(Ue)})}g(fe,$),Ze(),ge()}export{ts as G};
