import{e as n,W as d,ar as f,Y as l,as as h}from"./D0CSSuTl.js";import{c as p}from"./C8vxa4mj.js";function b(o,e,a){n(()=>{var r=d(()=>e(o,a?.())||{});if(a&&r?.update){var i=!1,t={};f(()=>{var s=a();l(s),i&&h(t,s)&&(t=s,r.update(s))}),i=!0}if(r?.destroy)return()=>r.destroy()})}class v{#r;#t;#e=()=>{};#s;get current(){return this.#t(),this.#r}set current(e){this.#s(e),this.#e(),this.#r=e}constructor(e,a,r){const i=r.read(e);this.#r=i===void 0?a:i,this.#s=t=>r.write(e,t),this.#t=p(t=>(this.#e=t,()=>{this.#e=()=>{}}))}}class g extends v{constructor(e,a,r={}){const i=r.valid||(()=>!0),t=r.serializer||JSON;super(e,a,{read:s=>{const c=localStorage.getItem(s)??void 0;if(c===void 0)return;const u=t.parse(c);if(i(u))return u},write:(s,c)=>{localStorage.setItem(s,t.stringify(c))}})}}export{g as P,b as a};
