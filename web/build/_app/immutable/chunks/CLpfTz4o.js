import"./DsnmJJEf.js";import{p as T,s as V,t as S,a as D,c as A,r as P,f as Z,g as u,h as E,u as K,j}from"./D0CSSuTl.js";import{s as $,e as F,r as ee}from"./C8vxa4mj.js";import{a as g,f as v}from"./Bd1JH_Ov.js";import{i as U}from"./D8NIUdeB.js";import{a as te}from"./IOA7-Wrn.js";import{a as G,bx as ae,q as H,ac as J,_ as re,s as w,p as se}from"./D-UYCH9y.js";import{p as t,s as ie,a as le}from"./zonMEKN6.js";import{$ as ne}from"./DWQ0JXRY.js";import{y as L}from"./DUXNbmIP.js";import{F as B}from"./BP6NvnZ7.js";var oe=v('<span class="text-center"> </span>'),de=v("<div><!> <!></div>");function ce(l,e){T(e,!0);const i=()=>le(ne,"$t",s),[s,n]=ie();let f=t(e,"class",3,""),y=t(e,"hideMessage",3,!1),h=t(e,"width",3,void 0),x=t(e,"height",3,void 0);var o=de();let m;var _=A(o);G(_,{get icon(){return ae},size:"7em",class:"max-w-full"});var C=V(_,2);{var I=d=>{var c=oe(),k=A(c,!0);P(c),S(M=>$(k,M),[()=>i()("error_loading_image")]),g(d,c)};U(C,d=>{y()||d(I)})}P(o),S(()=>{H(o,1,`flex flex-col overflow-hidden max-h-full max-w-full justify-center items-center bg-gray-100/40 dark:bg-gray-700/40 dark:text-gray-100 p-4 ${f()??""}`),m=J(o,"",m,{width:h(),height:x()})}),g(l,o),D(),n()}const fe=new BroadcastChannel("immich");function N(l){l&&fe.postMessage({type:"cancel",url:l})}class me{preload(e,i=B.Preview){if(!e)return;const s=L({id:e.id,size:i,cacheKey:e.thumbhash});if(!s)return;const n=new Image;n.src=s}cancel(e,i=B.Preview){if(!e)return;const s=i==="all"?Object.values(B):[i];for(const n of s){const f=L({id:e.id,size:n,cacheKey:e.thumbhash});f&&N(f)}}cancelPreloadUrl(e){e&&N(e)}}const ue=new me;var he=v('<img draggable="false"/>'),ge=v('<div class="absolute start-1/2 top-1/2 translate-x-[-50%] translate-y-[-50%] transform"><!></div>'),ve=v("<!> <!>",1);function Be(l,e){T(e,!0);let i=t(e,"title",3,null),s=t(e,"heightStyle",3,void 0),n=t(e,"curve",3,!1),f=t(e,"shadow",3,!1),y=t(e,"circle",3,!1),h=t(e,"hidden",3,!1),x=t(e,"border",3,!1),o=t(e,"hiddenIconClass",3,"text-white"),m=t(e,"onComplete",3,void 0),_=t(e,"class",3,""),C=t(e,"brokenAssetClass",3,""),I=t(e,"preload",3,!0),d=E(!1),c=E(!1);const k=()=>{j(d,!0),m()?.(!1)},M=()=>{j(c,!0),m()?.(!0)};function Q(r){return r.complete&&(j(d,!0),m()?.(!1)),{destroy:()=>ue.cancelPreloadUrl(e.url)}}let O=K(()=>[n()&&"rounded-xl",y()&&"rounded-full",f()&&"shadow-lg",(y()||!s())&&"aspect-square",x()&&"border-3 border-immich-dark-primary/80 hover:border-immich-primary",C()].filter(Boolean).join(" "));var p=ve(),q=Z(p);{var R=r=>{ce(r,{get class(){return u(O)},get width(){return e.widthStyle},get height(){return s()}})},W=r=>{var a=he();let b;te(a,z=>Q?.(z)),S(()=>{w(a,"src",e.url),w(a,"alt",u(d)||u(c)?e.altText:""),w(a,"title",i()),H(a,1,se(["object-cover",u(O),_()])),w(a,"loading",I()?"eager":"lazy"),b=J(a,"",b,{width:e.widthStyle,height:s(),filter:h()?"grayscale(50%)":"none",opacity:h()?"0.5":"1"})}),F("load",a,k),F("error",a,M),ee(a),g(r,a)};U(q,r=>{u(c)?r(R):r(W,!1)})}var X=V(q,2);{var Y=r=>{var a=ge(),b=A(a);{let z=K(()=>i()??void 0);G(b,{get title(){return u(z)},get icon(){return re},size:"2em",get class(){return o()}})}P(a),g(r,a)};U(X,r=>{h()&&r(Y)})}g(l,p),D()}export{ce as B,Be as I,ue as i};
