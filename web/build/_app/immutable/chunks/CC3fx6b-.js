import"./DsnmJJEf.js";import{d as B,o as G,s as H}from"./C8vxa4mj.js";import{p as J,h as K,i as L,f as w,c as n,g as e,r as o,s as $,u as a,a as Q,j as V,t as W}from"./D0CSSuTl.js";import{i as X}from"./D8NIUdeB.js";import{e as Y}from"./DLePdI2u.js";import{a as _,f as C,c as Z}from"./Bd1JH_Ov.js";import{aa as ee,a as te,w as ae,s as re}from"./D-UYCH9y.js";import{s as se,a as oe}from"./zonMEKN6.js";import{t as ie}from"./DUXNbmIP.js";import{o as le,p as ne}from"./BP6NvnZ7.js";import{$ as me}from"./DWQ0JXRY.js";import{S as ce}from"./BRztk81V.js";import{C as de}from"./DCmy867i.js";import{F as pe}from"./BMcevgEe.js";var ue=C('<div class="flex group transition-all"><span class="inline-block h-min whitespace-nowrap ps-3 pe-1 group-hover:ps-3 py-1 text-center align-baseline leading-none text-gray-100 dark:text-immich-dark-gray bg-primary roudned-s-full hover:bg-immich-primary/80 dark:hover:bg-immich-dark-primary/80 transition-all"><p class="text-sm"> </p></span> <button type="button" class="text-gray-100 dark:text-immich-dark-gray bg-immich-primary/95 dark:bg-immich-dark-primary/95 rounded-e-full place-items-center place-content-center pe-2 ps-1 py-1 hover:bg-immich-primary/80 dark:hover:bg-immich-dark-primary/80 transition-all"><!></button></div>'),ge=C('<div class="my-4 flex flex-col gap-2"><!></div> <section class="flex flex-wrap pt-2 gap-1"></section>',1);function Ie(T,m){J(m,!0);const i=()=>oe(me,"$t",S),[S,A]=se();let c=K(L([])),F=a(()=>Object.fromEntries(e(c).map(t=>[t.id,t]))),r=new ce,I=a(()=>r.size===0),M=!0;G(async()=>{V(c,await ne(),!0)});const z=async()=>{r.size!==0&&(await ie({tagIds:[...r],assetIds:m.assetIds,showNotification:!1}),m.onClose(!0))},j=async t=>{if(t)if(t.id)r.add(t.value);else{const[d]=await le({tagUpsertDto:{tags:[t.label]}});e(c).push(d),r.add(d.id)}},O=t=>{r.delete(t)};{let t=a(()=>i()("tag_assets")),d=a(()=>i()("tag_assets"));pe(T,{size:"small",get title(){return e(t)},get icon(){return ee},get onClose(){return m.onClose},onSubmit:z,get submitText(){return e(d)},get disabled(){return e(I)},children:(D,fe)=>{var y=ge(),f=w(y),E=n(f);{let l=a(()=>i()("tag")),p=a(()=>e(c).map(s=>({id:s.id,label:s.value,value:s.id}))),u=a(()=>i()("search_tags"));de(E,{onSelect:j,get label(){return e(l)},allowCreate:M,defaultFirstOption:!0,get options(){return e(p)},get placeholder(){return e(u)},forceFocus:!0})}o(f);var x=$(f,2);Y(x,20,()=>r,l=>l,(l,p)=>{const u=a(()=>e(F)[p]);var s=Z(),N=w(s);{var P=v=>{var h=ue(),b=n(h),k=n(b),R=n(k,!0);o(k),o(b);var g=$(b,2);g.__click=()=>O(p);var U=n(g);te(U,{get icon(){return ae}}),o(g),o(h),W(q=>{H(R,e(u).value),re(g,"title",q)},[()=>i()("remove_tag")]),_(v,h)};X(N,v=>{e(u)&&v(P)})}_(l,s)}),o(x),_(D,y)},$$slots:{default:!0}})}Q(),A()}B(["click"]);export{Ie as A};
