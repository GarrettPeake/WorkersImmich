const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["_app/immutable/chunks/7ZR7F41Y.js","_app/immutable/chunks/DsnmJJEf.js","_app/immutable/chunks/C8vxa4mj.js","_app/immutable/chunks/D0CSSuTl.js","_app/immutable/chunks/DIeogL5L.js","_app/immutable/chunks/Bd1JH_Ov.js","_app/immutable/chunks/D8NIUdeB.js","_app/immutable/chunks/orVkzVhB.js","_app/immutable/chunks/DLePdI2u.js","_app/immutable/chunks/BP6NvnZ7.js","_app/immutable/chunks/7tRQeUtl.js","_app/immutable/chunks/zonMEKN6.js","_app/immutable/chunks/D-UYCH9y.js","_app/immutable/chunks/CMI33r64.js","_app/immutable/chunks/gvLJu3l0.js","_app/immutable/chunks/BUApaBEI.js","_app/immutable/assets/Logo.REF6zmWd.css","_app/immutable/chunks/IOA7-Wrn.js","_app/immutable/chunks/dsDpGkcL.js","_app/immutable/chunks/BRztk81V.js","_app/immutable/chunks/0qPXRVhz.js","_app/immutable/chunks/DUXNbmIP.js","_app/immutable/chunks/DxRnQWdm.js","_app/immutable/chunks/CG4KAGH3.js","_app/immutable/chunks/BpCm29KX.js","_app/immutable/chunks/gegweU97.js","_app/immutable/chunks/DWQ0JXRY.js","_app/immutable/chunks/CJGyQpNN.js","_app/immutable/chunks/BVZhy_zG.js","_app/immutable/chunks/CIJfCxLq.js","_app/immutable/chunks/C_T4m_n1.js","_app/immutable/chunks/B2VKg7zy.js","_app/immutable/chunks/DcdhlkRn.js","_app/immutable/chunks/Q3VoKRsI.js","_app/immutable/chunks/DU5vAHPb.js","_app/immutable/chunks/DFvk55M8.js","_app/immutable/chunks/B9MV_P2E.js","_app/immutable/chunks/CwqKZNgJ.js","_app/immutable/chunks/DPMzVlQx.js","_app/immutable/chunks/CS-10t6W.js","_app/immutable/chunks/DW5CvR3c.js","_app/immutable/chunks/BHTYC334.js","_app/immutable/chunks/Tw41aoDi.js","_app/immutable/chunks/Bqqp8sy9.js","_app/immutable/chunks/CF_nq223.js","_app/immutable/chunks/WQ1yKytR.js","_app/immutable/chunks/DnqqNi3p.js","_app/immutable/chunks/oXVv5nIS.js","_app/immutable/chunks/ChL-L15l.js","_app/immutable/chunks/CoqJY867.js","_app/immutable/chunks/DS0yfrVF.js","_app/immutable/chunks/3Su-ePg-.js","_app/immutable/chunks/s_2UW97Q.js","_app/immutable/assets/Input.idyGuON4.css","_app/immutable/chunks/69_IOA4Y.js","_app/immutable/chunks/9chJ2bcr.js","_app/immutable/chunks/B8RZOa0L.js","_app/immutable/chunks/Dgf_MdoC.js","_app/immutable/chunks/BZ21-Ulh.js","_app/immutable/chunks/5Inb98wy.js","_app/immutable/chunks/FpAj0Eak.js","_app/immutable/chunks/BjFPDMuz.js","_app/immutable/chunks/msCV69PI.js","_app/immutable/chunks/CgXU4mBI.js","_app/immutable/chunks/D1613R3V.js","_app/immutable/chunks/Biw8UfMB.js","_app/immutable/chunks/BMcevgEe.js","_app/immutable/chunks/BgQCgJ0_.js","_app/immutable/chunks/BzOEcAd-.js","_app/immutable/chunks/i7F918yQ.js","_app/immutable/chunks/CLpfTz4o.js","_app/immutable/chunks/Cr9S0fVn.js","_app/immutable/chunks/BmJQ54Se.js","_app/immutable/chunks/D3D47pl8.js","_app/immutable/chunks/BOLL51yO.js","_app/immutable/chunks/GXf5CvES.js","_app/immutable/chunks/BitKOkE8.js","_app/immutable/chunks/jZIyHVjf.js","_app/immutable/chunks/CG2BHJh0.js","_app/immutable/chunks/DKzKigBY.js","_app/immutable/chunks/Cq6696VF.js","_app/immutable/chunks/C3VE5xEq.js","_app/immutable/chunks/BcI9YXFA.js","_app/immutable/assets/Textarea.CRksyXnO.css","_app/immutable/assets/activity-viewer.CwxlvmcY.css","_app/immutable/chunks/CbJ1QVsO.js","_app/immutable/assets/thumbnail.Di7rqjOL.css","_app/immutable/chunks/BVcN3VUI.js","_app/immutable/chunks/C0GZEybY.js","_app/immutable/chunks/DCmy867i.js","_app/immutable/chunks/CC3fx6b-.js","_app/immutable/chunks/BCf5NZQ6.js","_app/immutable/chunks/DxfhPdFw.js","_app/immutable/chunks/D5KKc-uL.js","_app/immutable/chunks/BbpJDI0d.js","_app/immutable/chunks/GyRE5G4-.js","_app/immutable/chunks/DDy4N4G7.js","_app/immutable/chunks/XSsqx5Lk.js","_app/immutable/chunks/Dt4pkAJO.js","_app/immutable/assets/asset-viewer.CSooJwqO.css"])))=>i.map(i=>d[i]);
import"./DsnmJJEf.js";import{p as ce,$ as xe,f as D,c as g,r as h,s as u,t as se,j as Z,g as e,a as me,u as f,h as ee,i as O,aU as Ue,n as ze,a1 as Oe}from"./D0CSSuTl.js";import{s as oe,e as Fe}from"./C8vxa4mj.js";import{a as d,f as b,c as le,t as Ge}from"./Bd1JH_Ov.js";import{i as w}from"./D8NIUdeB.js";import{h as He}from"./DYQnFuij.js";import{L as fe,I as J,bT as ye,bU as je,a5 as Se,a2 as qe,a7 as Qe,aj as We,s as Je,B as Ke}from"./D-UYCH9y.js";import{p as Ie,a as F,s as ue,d as Xe,e as Ye}from"./zonMEKN6.js";import{a as Ze}from"./IOA7-Wrn.js";import{a as et}from"./BVZhy_zG.js";import{A as tt,g as at}from"./CIJfCxLq.js";import{A as rt,a as st}from"./DYlKPt8j.js";import{D as Le}from"./vBkll8cH.js";import{S as ot}from"./C9R8P1Xg.js";import{A as De,g as nt}from"./CfdSAoAU.js";import{T as it}from"./BaHAZRvh.js";import{f as lt}from"./oXVv5nIS.js";import{g as _e}from"./gvLJu3l0.js";import"./BUApaBEI.js";import"./CG4KAGH3.js";import{az as dt,h as ct,S as we,aA as mt}from"./BP6NvnZ7.js";import{a as be,b as ut}from"./DxRnQWdm.js";import{h as he,e as Pe,d as vt,$ as gt}from"./DUXNbmIP.js";import{$ as ve}from"./DWQ0JXRY.js";import{h as ht}from"./BAR0RTAw.js";import{A as Me}from"./MMtgDOP-.js";import{a as Re}from"./Cr9S0fVn.js";import{d as de}from"./tPj2J2UR.js";import{m as Te}from"./DW5CvR3c.js";import{S as ft,a as pt,s as _t}from"./BOLL51yO.js";import{f as Ce,o as Be}from"./WQ1yKytR.js";import{C as pe}from"./D-550RMt.js";import{T as Ve}from"./CdYsFlcU.js";import{_ as wt,A as ge}from"./0qPXRVhz.js";import{a as $e}from"./Biw8UfMB.js";import{b as Ae}from"./Dgf_MdoC.js";import{c as bt}from"./CgXU4mBI.js";import{R as ke}from"./gegweU97.js";import{t as $t,h as Ee}from"./DLePdI2u.js";import{t as At}from"./CF_nq223.js";import{G as kt}from"./B6eBVnDA.js";import{u as xt}from"./CJGyQpNN.js";import{P as yt}from"./BzOEcAd-.js";var St=b('<p class="whitespace-pre-line mb-12 mt-6 w-full pb-2 text-start font-medium text-base text-black dark:text-gray-300"> </p>'),It=b('<section class="pt-8 md:pt-24 px-2 md:px-0"><h1 class="text-2xl md:text-4xl lg:text-6xl text-primary outline-none transition-all"> </h1> <!> <!></section>'),Lt=b("<!> <!>",1),Dt=b('<a data-sveltekit-preload-data="hover" class="ms-4" href="/"><!></a>'),Pt=b("<!> <!>",1),Mt=b("<!> <!> <!> <!> <!>",1),Rt=b('<main class="relative h-dvh overflow-hidden px-2 md:px-6 max-md:pt-(--navbar-height-md) pt-(--navbar-height)"><!></main> <header><!></header>',1);function Tt(G,p){ce(p,!0);const P=()=>F(ae,"$slideshowNavigation",v),x=()=>F(ve,"$t",v),H=()=>F($,"$showAssetViewer",v),[v,N]=ue();let R=Ie(p,"user",3,void 0);const a=p.sharedLink.album;let{isViewing:$,setAssetId:T}=Re,{slideshowState:te,slideshowNavigation:ae}=_t;const K=f(()=>({albumId:a.id,order:a.order}));let V=ee(void 0);const M=new Me;de.subscribe(o=>{o.isDragging&&o.files.length>0&&(he(Ce({files:o.files,albumId:a.id})),de.set({isDragging:!1,files:[]}))});const X=async()=>{const o=P()===ft.Shuffle?await e(V).getRandomAsset():e(V).months[0]?.dayGroups[0]?.viewerAssets[0]?.asset;o&&he(T(o.id).then(()=>Xe(te,pt.PlaySlideshow)))},n=f(()=>at(x())),A=f(()=>e(n).Cast);var E=Rt();Ze(xe,(o,k)=>et?.(o,k),()=>({shortcut:{key:"Escape"},onShortcut:()=>{!H()&&M.selectionActive&&Pe(M)}}));var C=D(E),y=g(C);it(y,{enableRouting:!0,get album(){return a},get options(){return e(K)},get assetInteraction(){return M},get timelineManager(){return e(V)},set timelineManager(o){Z(V,o,!0)},children:(o,k)=>{var t=It(),r=g(t),i=g(r,!0);h(r);var c=u(r,2);{var m=I=>{rt(I,{get album(){return a}})};w(c,I=>{a.assetCount>0&&I(m)})}var s=u(c,2);{var l=I=>{var B=St(),q=g(B,!0);h(B),se(()=>oe(q,a.description)),d(I,B)};w(s,I=>{a.description&&I(l)})}h(t),se(()=>oe(i,a.albumName)),d(o,t)},$$slots:{default:!0}}),h(C);var S=u(C,2),j=g(S);{var _=o=>{{let k=f(()=>R()?.id);De(o,{get ownerId(){return e(k)},get assets(){return M.selectedAssets},clearSelect:()=>M.clearMultiselect(),children:(t,r)=>{var i=Lt(),c=D(i);ot(c,{get timelineManager(){return e(V)},get assetInteraction(){return M}});var m=u(c,2);{var s=l=>{Le(l,{get filename(){return`${a.albumName??""}.zip`}})};w(m,l=>{p.sharedLink.allowDownload&&l(s)})}d(t,i)},$$slots:{default:!0}})}},U=o=>{pe(o,{showBackButton:!1,leading:r=>{var i=Dt(),c=g(i);{let m=f(()=>Te.maxMd?"icon":"inline");fe(c,{get variant(){return e(m)},class:"min-w-10"})}h(i),d(r,i)},trailing:r=>{var i=Mt(),c=D(i);tt(c,{get action(){return e(A)}});var m=u(c,2);{var s=L=>{{let Q=f(()=>x()("add_photos"));J(L,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(Q)},onclick:()=>Be({albumId:a.id}),get icon(){return ye}})}};w(m,L=>{p.sharedLink.allowUpload&&L(s)})}var l=u(m,2);{var I=L=>{var Q=Pt(),ie=D(Q);{let W=f(()=>x()("slideshow"));J(ie,{shape:"round",variant:"ghost",color:"secondary",get"aria-label"(){return e(W)},onclick:X,get icon(){return je}})}var z=u(ie,2);{let W=f(()=>x()("download"));J(z,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(W)},onclick:()=>ht(a),get icon(){return Se}})}d(L,Q)};w(l,L=>{a.assetCount>0&&p.sharedLink.allowDownload&&L(I)})}var B=u(l,2);{var q=L=>{st(L,{get album(){return a}})};w(B,L=>{p.sharedLink.showMetadata&&lt.value.map&&L(q)})}var ne=u(B,2);Ve(ne,{}),d(r,i)},$$slots:{leading:!0,trailing:!0}})};w(j,o=>{M.selectionActive?o(_):o(U,!1)})}h(S),d(G,E),me(),N()}function Ct(G,p){ce(p,!0);const P=()=>F(ve,"$t",x),[x,H]=ue(),{getAssets:v,clearSelect:N}=nt(),R=async()=>{const a=v().map(({id:T})=>T);await bt(p.sharedLink,a)&&N()};{let a=f(()=>P()("remove_from_shared_link"));J(G,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(a)},onclick:R,get icon(){return qe}})}me(),H()}var Bt=b("<!> <!> <!>",1),Vt=b('<a data-sveltekit-preload-data="hover" class="ms-4" href="/"><!></a>'),Et=b("<!> <!>",1),Nt=b('<!> <section class="my-40 mx-4"><!></section>',1),Ut=b("<section><!></section>");function zt(G,p){ce(p,!0);const P=()=>F(ve,"$t",x),[x,H]=ue();let v=Ie(p,"sharedLink",15);const N=O({width:0,height:0}),R=new Me;let a=f(()=>v().assets);de.subscribe(n=>{n.isDragging&&n.files.length>0&&(he(T(n.files)),de.set({isDragging:!1,files:[]}))});const $=async()=>{await vt("immich-shared.zip",{assetIds:e(a).map(n=>n.id)})},T=async(n=[])=>{try{let A=[];A=await(!n||n.length===0||!Array.isArray(n)?Be():Ce({files:n}));const C=(await dt({...be.params,id:v().id,assetIdsDto:{assetIds:A.filter(y=>!!y)}})).filter(y=>y.success).length;$t.success(P()("assets_added_count",{values:{count:C}}))}catch(A){Ee(A,P()("errors.unable_to_add_assets_to_shared_link"))}},te=()=>{R.selectAssets(e(a).map(n=>At(n)))},ae=async n=>{switch(n.type){case ge.ARCHIVE:case ge.DELETE:case ge.TRASH:{await _e(ke.photos());break}}};var K=Ut(),V=g(K);{var M=n=>{var A=Nt(),E=D(A);{var C=_=>{De(_,{get assets(){return R.selectedAssets},clearSelect:()=>Pe(R),children:(U,o)=>{var k=Bt(),t=D(k);{let s=f(()=>P()("select_all"));J(t,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(s)},get icon(){return Qe},onclick:te})}var r=u(t,2);{var i=s=>{Le(s,{filename:"immich-shared.zip"})};w(r,s=>{v()?.allowDownload&&s(i)})}var c=u(r,2);{var m=s=>{Ct(s,{get sharedLink(){return v()},set sharedLink(l){v(l)}})};w(c,s=>{p.isOwned&&s(m)})}d(U,k)},$$slots:{default:!0}})},y=_=>{pe(_,{onClose:()=>_e(ke.photos()),get backIcon(){return We},showBackButton:!1,leading:k=>{var t=Vt(),r=g(t);{let i=f(()=>Te.maxMd?"icon":"inline");fe(r,{get variant(){return e(i)},class:"min-w-10"})}h(t),d(k,t)},trailing:k=>{var t=Et(),r=D(t);{var i=s=>{{let l=f(()=>P()("add_photos"));J(s,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(l)},onclick:()=>T(),get icon(){return ye}})}};w(r,s=>{v()?.allowUpload&&s(i)})}var c=u(r,2);{var m=s=>{{let l=f(()=>P()("download"));J(s,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(l)},onclick:$,get icon(){return Se}})}};w(c,s=>{v()?.allowDownload&&s(m)})}d(k,t)},$$slots:{leading:!0,trailing:!0}})};w(E,_=>{R.selectionActive?_(C):_(y,!1)})}var S=u(E,2),j=g(S);kt(j,{get assets(){return e(a)},get assetInteraction(){return R},get viewport(){return N}}),h(S),Ae(S,"clientHeight",_=>N.height=_),Ae(S,"clientWidth",_=>N.width=_),d(n,A)},X=n=>{var A=le(),E=D(A);{var C=y=>{var S=le(),j=D(S);$e(j,()=>ct({...be.params,id:e(a)[0].id}),null,(_,U)=>{var o=le(),k=D(o);$e(k,()=>wt(()=>import("./7ZR7F41Y.js").then(t=>t.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99])),null,(t,r)=>{var i=f(()=>{var{default:l}=e(r);return{AssetViewer:l}}),c=f(()=>e(i).AssetViewer),m=le(),s=D(m);{let l=f(()=>({current:e(U)}));Ye(s,()=>e(c),(I,B)=>{B(I,{get cursor(){return e(l)},onAction:ae})})}d(t,m)}),d(_,o)}),d(y,S)};w(E,y=>{e(a).length===1&&y(C)},!0)}d(n,A)};w(V,n=>{v()?.allowUpload||e(a).length>1?n(M):n(X,!1)})}h(K),d(G,K),me(),H()}var Ot=b('<meta name="description"/>'),Ft=b('<a data-sveltekit-preload-data="hover" class="ms-4" href="/"><!></a>'),Gt=b('<main class="relative h-dvh overflow-hidden px-6 max-md:pt-(--navbar-height-md) pt-(--navbar-height) sm:px-12 md:px-24 lg:px-40"><div class="flex flex-col items-center justify-center mt-20"><div class="text-2xl font-bold text-primary"> </div> <div class="mt-4 text-lg text-primary"> </div> <div class="mt-4"><form class="flex gap-x-2" novalidate=""><!> <!></form></div></div></main> <header><!></header>',1),Ht=b('<div class="immich-scrollbar"><!></div>'),jt=b("<!> <!> <!>",1);function Ba(G,p){ce(p,!0);const P=()=>F(xt,"$user",v),x=()=>F(ve,"$t",v),H=()=>F(R,"$gridScrollTarget",v),[v,N]=ue();let{gridScrollTarget:R}=Re,a=p.data,$=ee(O(a.sharedLink)),T=ee(O(a.passwordRequired)),te=O(a.key),ae=O(a.slug),V=O(a.meta),M=ee(O(V.title)),X=ee(O(V.description)),n=f(()=>P()?P().id===e($)?.userId:!1),A=ee("");const E=async()=>{try{Z($,await mt({password:e(A),key:te,slug:ae}),!0),gt(e($)),Z(T,!1),Z(M,(e($).album?e($).album.albumName:x()("public_share"))+" - Immich"),Z(X,e($).description||x()("shared_photos_and_videos_count",{values:{assetCount:e($).assets.length}}),!0),await Oe(),await ut({targetRoute:"current",assetId:null,assetGridRouteSearchParams:H()},{forceNavigate:!0,replaceState:!0})}catch(t){Ee(t,x()("errors.unable_to_get_shared_link"))}},C=async t=>{t.preventDefault(),await E()};var y=jt();He("5syozd",t=>{var r=Ot();se(()=>Je(r,"content",e(X))),Ue(()=>{xe.title=e(M)??""}),d(t,r)});var S=D(y);{var j=t=>{var r=Gt(),i=D(r),c=g(i),m=g(c),s=g(m,!0);h(m);var l=u(m,2),I=g(l,!0);h(l);var B=u(l,2),q=g(B),ne=g(q);yt(ne,{autocomplete:"off",placeholder:"Password",get value(){return e(A)},set value(z){Z(A,z,!0)}});var L=u(ne,2);Ke(L,{type:"submit",children:(z,W)=>{ze();var Y=Ge();se(re=>oe(Y,re),[()=>x()("submit")]),d(z,Y)},$$slots:{default:!0}}),h(q),h(B),h(c),h(i);var Q=u(i,2),ie=g(Q);pe(ie,{showBackButton:!1,leading:Y=>{var re=Ft(),Ne=g(re);fe(Ne,{variant:"inline"}),h(re),d(Y,re)},trailing:Y=>{Ve(Y,{})},$$slots:{leading:!0,trailing:!0}}),h(Q),se((z,W)=>{oe(s,z),oe(I,W)},[()=>x()("password_required"),()=>x()("sharing_enter_password")]),Fe("submit",q,C),d(t,r)};w(S,t=>{e(T)&&t(j)})}var _=u(S,2);{var U=t=>{Tt(t,{get sharedLink(){return e($)}})};w(_,t=>{!e(T)&&e($)?.type==we.Album&&t(U)})}var o=u(_,2);{var k=t=>{var r=Ht(),i=g(r);zt(i,{get sharedLink(){return e($)},get isOwned(){return e(n)}}),h(r),d(t,r)};w(o,t=>{!e(T)&&e($)?.type==we.Individual&&t(k)})}d(G,y),me(),N()}export{Ba as S};
