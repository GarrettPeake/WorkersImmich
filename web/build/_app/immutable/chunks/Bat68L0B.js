import{g as N}from"./gvLJu3l0.js";import{e as g}from"./BpCm29KX.js";import"./DsnmJJEf.js";import{p as C,f as D,n as E,t as F,s as S,j as U,g as o,u as p,a as z,h as M,i as X}from"./D0CSSuTl.js";import{s as T}from"./C8vxa4mj.js";import{t as k,a as L,f as O}from"./Bd1JH_Ov.js";import{a as I,s as Q}from"./zonMEKN6.js";import{T as R,aK as B,ch as Y,aZ as Z,K as J,bm as W,ab as V}from"./D-UYCH9y.js";import{$ as K,g as _}from"./DWQ0JXRY.js";import{F as j}from"./BMcevgEe.js";import{F as q}from"./BgQCgJ0_.js";import{I as G}from"./s_2UW97Q.js";import{R as H}from"./gegweU97.js";import{t as u,h as b}from"./DLePdI2u.js";import{aR as tt,aS as P,aT as et,aU as rt,aF as at,aG as st,aE as nt}from"./BP6NvnZ7.js";import{m as $}from"./BHTYC334.js";var ot=O("<!> <!>",1);function it(t,e){C(e,!0);const r=()=>I(K,"$t",a),[a,n]=Q();let s=M("");const f=async()=>{await Lt(e.library,o(s))&&e.onClose()};{let c=p(()=>r()("add_exclusion_pattern")),v=p(()=>r()("add"));j(t,{get title(){return o(c)},get icon(){return B},get onClose(){return e.onClose},onSubmit:f,get submitText(){return o(v)},size:"small",children:(A,w)=>{var m=ot(),h=D(m);R(h,{size:"small",class:"mb-4",children:(l,d)=>{E();var i=k();F(x=>T(i,x),[()=>r()("admin.exclusion_pattern_description")]),L(l,i)},$$slots:{default:!0}});var y=S(h,2);{let l=p(()=>r()("pattern"));q(y,{get label(){return o(l)},children:(d,i)=>{G(d,{get value(){return o(s)},set value(x){U(s,x,!0)}})},$$slots:{default:!0}})}L(A,m)},$$slots:{default:!0}})}z(),n()}var ct=O("<!> <!>",1);function lt(t,e){C(e,!0);const r=()=>I(K,"$t",a),[a,n]=Q();let s=M(X(e.exclusionPattern));const f=async()=>{await $t(e.library,e.exclusionPattern,o(s))&&e.onClose()};{let c=p(()=>r()("edit_exclusion_pattern"));j(t,{get title(){return o(c)},get icon(){return B},get onClose(){return e.onClose},onSubmit:f,size:"small",children:(v,A)=>{var w=ct(),m=D(w);R(m,{size:"small",class:"mb-4",children:(y,l)=>{E();var d=k();F(i=>T(d,i),[()=>r()("admin.exclusion_pattern_description")]),L(y,d)},$$slots:{default:!0}});var h=S(m,2);{let y=p(()=>r()("pattern"));q(h,{get label(){return o(y)},children:(l,d)=>{G(l,{get value(){return o(s)},set value(i){U(s,i,!0)}})},$$slots:{default:!0}})}L(v,w)},$$slots:{default:!0}})}z(),n()}var dt=O("<!> <!>",1);function ut(t,e){C(e,!0);const r=()=>I(K,"$t",a),[a,n]=Q();let s=M("");const f=async()=>{await ft(e.library,o(s))&&e.onClose()};{let c=p(()=>r()("library_add_folder")),v=p(()=>r()("add"));j(t,{get title(){return o(c)},get icon(){return B},get onClose(){return e.onClose},onSubmit:f,size:"small",get submitText(){return o(v)},children:(A,w)=>{var m=dt(),h=D(m);R(h,{size:"small",class:"mb-4",children:(l,d)=>{E();var i=k();F(x=>T(i,x),[()=>r()("admin.library_folder_description")]),L(l,i)},$$slots:{default:!0}});var y=S(h,2);{let l=p(()=>r()("path"));q(y,{get label(){return o(l)},children:(d,i)=>{G(d,{get value(){return o(s)},set value(x){U(s,x,!0)}})},$$slots:{default:!0}})}L(A,m)},$$slots:{default:!0}})}z(),n()}var mt=O("<!> <!>",1);function yt(t,e){C(e,!0);const r=()=>I(K,"$t",a),[a,n]=Q();let s=M(X(e.folder));const f=async()=>{await ht(e.library,e.folder,o(s))&&e.onClose()};{let c=p(()=>r()("library_edit_folder"));j(t,{get title(){return o(c)},get icon(){return B},get onClose(){return e.onClose},onSubmit:f,size:"small",children:(v,A)=>{var w=mt(),m=D(w);R(m,{size:"small",class:"mb-4",children:(y,l)=>{E();var d=k();F(i=>T(d,i),[()=>r()("admin.library_folder_description")]),L(y,d)},$$slots:{default:!0}});var h=S(m,2);{let y=p(()=>r()("path"));q(h,{get label(){return o(y)},children:(l,d)=>{G(l,{get value(){return o(s)},set value(i){U(s,i,!0)}})},$$slots:{default:!0}})}L(v,w)},$$slots:{default:!0}})}z(),n()}const Qt=(t,e)=>{const r={title:t("scan_all_libraries"),type:t("command"),icon:Y,onAction:()=>_t(),shortcuts:{shift:!0,key:"r"},$if:()=>e.length>0},a={title:t("create_library"),type:t("command"),icon:Z,onAction:()=>N(H.newLibrary()),shortcuts:{shift:!0,key:"n"}};return{ScanAll:r,Create:a}},Rt=(t,e)=>{const r={icon:V,type:t("command"),title:t("details"),onAction:()=>N(H.viewLibrary(e))},a={icon:W,type:t("command"),title:t("edit"),onAction:()=>N(H.editLibrary(e)),shortcuts:{key:"r"}},n={icon:J,type:t("command"),title:t("delete"),color:"danger",onAction:()=>pt(e),shortcuts:{key:"Backspace"}},s={icon:Z,type:t("command"),title:t("add"),onAction:()=>$.show(ut,{library:e})},f={icon:Z,type:t("command"),title:t("add"),onAction:()=>$.show(it,{library:e})},c={icon:Y,type:t("command"),title:t("scan_library"),onAction:()=>bt(e),shortcuts:{shift:!0,key:"r"}};return{Detail:r,Edit:a,Delete:n,AddFolder:s,AddExclusionPattern:f,Scan:c}},Bt=(t,e,r)=>{const a={icon:W,type:t("command"),title:t("edit"),onAction:()=>$.show(yt,{folder:r,library:e})},n={icon:J,type:t("command"),title:t("delete"),onAction:()=>gt(e,r)};return{Edit:a,Delete:n}},Kt=(t,e,r)=>{const a={icon:W,type:t("command"),title:t("edit"),onAction:()=>$.show(lt,{exclusionPattern:r,library:e})},n={icon:J,type:t("command"),title:t("delete"),onAction:()=>vt(e,r)};return{Edit:a,Delete:n}},_t=async()=>{const t=await _();try{await at({name:nt.Library,queueCommandDto:{command:st.Start}}),u.info(t("admin.refreshing_all_libraries"))}catch(e){b(e,t("errors.unable_to_scan_libraries"))}},bt=async t=>{const e=await _();try{await et({id:t.id}),u.info(e("admin.scanning_library"))}catch(r){b(r,e("errors.unable_to_scan_library"))}},jt=async t=>{const e=await _();try{const r=await tt({createLibraryDto:t});return g.emit("LibraryCreate",r),u.success(e("admin.library_created",{values:{library:r.name}})),r}catch(r){b(r,e("errors.unable_to_create_library"))}},qt=async(t,e)=>{const r=await _();try{const a=await P({id:t.id,updateLibraryDto:e});return g.emit("LibraryUpdate",a),u.success(r("admin.library_updated")),!0}catch(a){return b(a,r("errors.unable_to_update_library")),!1}},pt=async t=>{const e=await _();if(await $.showDialog({prompt:e("admin.confirm_delete_library",{values:{library:t.name}})})&&!(t.assetCount>0&&!await $.showDialog({prompt:e("admin.confirm_delete_library_assets",{values:{count:t.assetCount}})})))try{await rt({id:t.id}),g.emit("LibraryDelete",{id:t.id}),u.success(e("admin.library_deleted"))}catch(a){b(a,e("errors.unable_to_remove_library"))}},ft=async(t,e)=>{const r=await _();if(t.importPaths.includes(e))return u.danger(r("errors.library_folder_already_exists")),!1;try{const a=await P({id:t.id,updateLibraryDto:{importPaths:[...t.importPaths,e]}});g.emit("LibraryUpdate",a),u.success(r("admin.library_updated"))}catch(a){return b(a,r("errors.unable_to_update_library")),!1}return!0},ht=async(t,e,r)=>{const a=await _();if(e===r)return!0;const n=t.importPaths.map(s=>s===e?r:s);try{const s=await P({id:t.id,updateLibraryDto:{importPaths:n}});g.emit("LibraryUpdate",s),u.success(a("admin.library_updated"))}catch(s){return b(s,a("errors.unable_to_update_library")),!1}return!0},gt=async(t,e)=>{const r=await _();if(await $.showDialog({prompt:r("admin.library_remove_folder_prompt"),confirmText:r("remove")}))try{const n=await P({id:t.id,updateLibraryDto:{importPaths:t.importPaths.filter(s=>s!==e)}});g.emit("LibraryUpdate",n),u.success(r("admin.library_updated"))}catch(n){b(n,r("errors.unable_to_update_library"))}},Lt=async(t,e)=>{const r=await _();if(t.exclusionPatterns.includes(e))return u.danger(r("errors.exclusion_pattern_already_exists")),!1;try{const a=await P({id:t.id,updateLibraryDto:{exclusionPatterns:[...t.exclusionPatterns,e]}});g.emit("LibraryUpdate",a),u.success(r("admin.library_updated"))}catch(a){return b(a,r("errors.unable_to_update_library")),!1}return!0},$t=async(t,e,r)=>{const a=await _();if(e===r)return!0;const n=t.exclusionPatterns.map(s=>s===e?r:s);try{const s=await P({id:t.id,updateLibraryDto:{exclusionPatterns:n}});g.emit("LibraryUpdate",s),u.success(a("admin.library_updated"))}catch(s){return b(s,a("errors.unable_to_update_library")),!1}return!0},vt=async(t,e)=>{const r=await _();if(await $.showDialog({prompt:r("admin.library_remove_exclusion_pattern_prompt")}))try{const n=await P({id:t.id,updateLibraryDto:{exclusionPatterns:t.exclusionPatterns.filter(s=>s!==e)}});g.emit("LibraryUpdate",n),u.success(r("admin.library_updated"))}catch(n){b(n,r("errors.unable_to_update_library"))}};export{ut as L,Qt as a,qt as b,Bt as c,Kt as d,Rt as g,jt as h};
