import{e as q}from"./BpCm29KX.js";import"./DsnmJJEf.js";import{p as ue,f as ee,n as ne,t as z,s as u,c as s,j as E,g as o,r,a as ve,u as l,aD as de,h as be,a1 as xe}from"./D0CSSuTl.js";import{s as Q,d as we,o as $e}from"./C8vxa4mj.js";import{t as le,a as y,f as U}from"./Bd1JH_Ov.js";import{i as me}from"./D8NIUdeB.js";import{a as _e,s as fe,p as X}from"./zonMEKN6.js";import{D as Pe}from"./BCf5NZQ6.js";import{t as S,h as C,e as De}from"./DLePdI2u.js";import{$ as he,g as L}from"./DWQ0JXRY.js";import{a5 as G,a6 as Me}from"./BP6NvnZ7.js";import{T as Te,b9 as ke,B as Ue,$ as Se,_ as Ce,ay as Fe,az as He,ba as Ie,a as ce,bb as Oe,I as je,bc as Be,aj as Ae,q as ze}from"./D-UYCH9y.js";import{m as Ee}from"./BHTYC334.js";import{F as ge}from"./BMcevgEe.js";import{x as Y}from"./DUXNbmIP.js";import{I as Z}from"./CLpfTz4o.js";var qe=U('<div class="flex justify-end"><!></div>'),Le=U('<!> <div class="my-4 flex flex-col gap-2"><!> <!></div>',1);function Ge(a,e){ue(e,!0);const t=()=>_e(he,"$t",c),[c,F]=fe();let i=l(()=>e.person.birthDate??"");const n=async()=>{await Re(e.person,o(i))&&e.onClose()},d=new Date().toISOString().split("T")[0];{let v=l(()=>t()("set_date_of_birth"));ge(a,{get title(){return o(v)},size:"small",get icon(){return ke},get onClose(){return e.onClose},onSubmit:n,children:(R,te)=>{var J=Le(),m=ee(J);Te(m,{size:"small",children:(_,x)=>{ne();var f=le();z(H=>Q(f,H),[()=>t()("birthdate_set_description")]),y(_,f)},$$slots:{default:!0}});var b=u(m,2),P=s(b);Pe(P,{class:"immich-form-input",id:"birthDate",name:"birthDate",type:"date",get max(){return d},get value(){return o(i)},set value(_){E(i,_)}});var D=u(P,2);{var V=_=>{var x=qe(),f=s(x);Ue(f,{shape:"round",color:"secondary",size:"small",onclick:()=>E(i,""),children:(H,re)=>{ne();var K=le();z(I=>Q(K,I),[()=>t()("clear")]),y(H,K)},$$slots:{default:!0}}),r(x),y(_,x)};me(D,_=>{e.person.birthDate&&_(V)})}r(b),y(R,J)},$$slots:{default:!0}})}ve(),F()}const ft=(a,e)=>{const t={title:a("set_date_of_birth"),icon:Ie,onAction:()=>Ee.show(Ge,{person:e})},c={title:a("to_favorite"),icon:He,$if:()=>!e.isFavorite,onAction:()=>Je(e)},F={title:a("unfavorite"),icon:Fe,$if:()=>!!e.isFavorite,onAction:()=>Ke(e)},i={title:a("hide_person"),icon:Ce,$if:()=>!e.isHidden,onAction:()=>Ne(e)},n={title:a("unhide_person"),icon:Se,$if:()=>!!e.isHidden,onAction:()=>Qe(e)};return{SetDateOfBirth:t,Favorite:c,Unfavorite:F,HidePerson:i,ShowPerson:n}},Je=async a=>{const e=await L();try{const t=await G({id:a.id,personUpdateDto:{isFavorite:!0}});q.emit("PersonUpdate",t),S.success(e("added_to_favorites"))}catch(t){C(t,e("errors.unable_to_add_remove_favorites",{values:{favorite:!1}}))}},Ke=async a=>{const e=await L();try{const t=await G({id:a.id,personUpdateDto:{isFavorite:!1}});q.emit("PersonUpdate",t),S.success(e("removed_from_favorites"))}catch(t){C(t,e("errors.unable_to_add_remove_favorites",{values:{favorite:!1}}))}},Ne=async a=>{const e=await L();try{const t=await G({id:a.id,personUpdateDto:{isHidden:!0}});S.success(e("changed_visibility_successfully")),q.emit("PersonUpdate",t)}catch(t){C(t,e("errors.unable_to_hide_person"))}},Qe=async a=>{const e=await L();try{const t=await G({id:a.id,personUpdateDto:{isHidden:!1}});S.success(e("changed_visibility_successfully")),q.emit("PersonUpdate",t)}catch(t){C(t,e("errors.something_went_wrong"))}},Re=async(a,e)=>{const t=await L();try{const c=await G({id:a.id,personUpdateDto:{birthDate:e}});return S.success(t("date_of_birth_saved")),q.emit("PersonUpdate",c),!0}catch(c){C(c,t("errors.unable_to_save_date_of_birth"))}};var Ve=U('<div class="flex h-20 w-20 items-center px-1 md:h-24 md:w-24 md:px-2"><!></div> <div class="grid grid-rows-3"><div></div> <div class="flex flex-col h-full items-center justify-center"><div class="flex h-full items-center justify-center"><!></div></div> <div><!></div></div> <button type="button" class="flex h-28 w-28 items-center rounded-full border-2 border-immich-primary px-1 dark:border-immich-dark-primary md:h-32 md:w-32 md:px-2"><!></button>',1),We=U('<div class="h-24 w-24 md:h-28 md:w-28"><button type="button" class="p-2 w-full"><!></button></div>'),Xe=U('<div class="grid w-full grid-cols-1 gap-2"><div class="px-2"><button type="button"><!></button></div> <div class="flex items-center justify-center"><div></div></div></div>'),Ye=U('<div class="flex items-center justify-center gap-2 py-4 md:h-36"><!></div> <div class="flex px-4 md:pt-4"><h1 class="text-xl text-gray-500 dark:text-gray-300"> </h1></div> <div class="flex px-4 pt-2"><p class="text-sm text-gray-500 dark:text-gray-300"> </p></div>',1);function ht(a,e){ue(e,!0);const t=()=>_e(he,"$t",c),[c,F]=fe();let i=X(e,"personToMerge",15),n=X(e,"personToBeMergedInto",15),d=X(e,"potentialMergePeople",15),v=be(!1);const R=n().name,te=m=>{const b=d().indexOf(m);(P=>{var D=de(P,2);d(d()[b]=D[0],!0),n(D[1])})([n(),d()[b]]),E(v,!1)},J=async()=>{try{await Me({id:n().id,mergePersonDto:{ids:[i().id]}}),S.success(t()("merge_people_successfully")),e.onClose([i(),n()])}catch(m){C(m,t()("errors.unable_to_save_name"))}};$e(async()=>{await xe(),document.querySelector("#merge-confirm-button")?.focus()});{let m=l(()=>t()("merge_people")),b=l(()=>R),P=l(()=>t()("yes")),D=l(()=>t()("no"));ge(a,{get title(){return`${o(m)??""} - ${o(b)??""}`},submitColor:"primary",get submitText(){return o(P)},get cancelText(){return o(D)},get onClose(){return e.onClose},onSubmit:J,children:(V,_)=>{var x=Ye(),f=ee(x),H=s(f);{var re=h=>{var g=Ve(),w=ee(g),O=s(w);{let $=l(()=>Y(i()));Z(O,{circle:!0,shadow:!0,get url(){return o($)},get altText(){return i().name},widthStyle:"100%"})}r(w);var j=u(w,2),M=u(s(j),2),T=s(M),B=s(T);ce(B,{get icon(){return Oe},size:"48",class:"rotate-90 dark:text-white"}),r(T),r(M);var k=u(M,2),A=s(k);{let $=l(()=>t()("swap_merge_direction"));je(A,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return o($)},get icon(){return Be},onclick:()=>(N=>{var ie=de(N,2);return i(ie[0]),n(ie[1]),N})([n(),i()])})}r(k),r(j);var p=u(j,2);p.__click=()=>{d().length>0&&E(v,!o(v))};var W=s(p);{let $=l(()=>d().length>0),N=l(()=>Y(n()));Z(W,{get border(){return o($)},circle:!0,shadow:!0,get url(){return o(N)},get altText(){return n().name},widthStyle:"100%"})}r(p),z(()=>p.disabled=d().length===0),y(h,g)},K=h=>{var g=Xe(),w=s(g),O=s(w);O.__click=()=>E(v,!1);var j=s(O);ce(j,{get icon(){return Ae}}),r(O),r(w);var M=u(w,2),T=s(M);De(T,21,d,B=>B.id,(B,k)=>{var A=We(),p=s(A);p.__click=()=>te(o(k));var W=s(p);{let $=l(()=>Y(o(k)));Z(W,{border:!0,circle:!0,shadow:!0,get url(){return o($)},get altText(){return o(k).name},widthStyle:"100%"})}r(p),r(A),y(B,A)}),r(T),r(M),r(g),z(()=>ze(T,1,`flex flex-wrap justify-center md:grid md:grid-cols-${d().length??""}`)),y(h,g)};me(H,h=>{o(v)?h(K,!1):h(re)})}r(f);var I=u(f,2),ae=s(I),pe=s(ae,!0);r(ae),r(I);var se=u(I,2),oe=s(se),ye=s(oe,!0);r(oe),r(se),z((h,g)=>{Q(pe,h),Q(ye,g)},[()=>t()("are_these_the_same_person"),()=>t()("they_will_be_merged_together")]),y(V,x)},$$slots:{default:!0}})}ve(),F()}we(["click"]);export{ht as P,ft as g};
