import"./DsnmJJEf.js";import{p as W,c as f,b as ue,r as c,a as N,V as se,g as i,f as Z,n as I,t as z,s as _,j as H,h as re,u as V,i as ve,ae as we}from"./D0CSSuTl.js";import{p as oe,r as ke,c as Pe}from"./zonMEKN6.js";import{s as A}from"./C8vxa4mj.js";import{a as o,f as x,t as M,c as me}from"./Bd1JH_Ov.js";import{i as $}from"./D8NIUdeB.js";import{e as fe}from"./DLePdI2u.js";import{a as Se}from"./IOA7-Wrn.js";import{n as Ce,h as Ie,i as he,B as ze,T as K,a as R,C as le,u as Ae,x as Me,l as O,dn as ie,co as De,dp as Be,dq as Ee,dh as de,H as Fe,dr as Ke,ds as $e}from"./D-UYCH9y.js";import{B as je}from"./DKzKigBY.js";import{s as ge}from"./CMI33r64.js";import{I as Le}from"./s_2UW97Q.js";import{M as Te,a as Ue,b as Oe,m as He}from"./BHTYC334.js";import{c as qe,S as Qe}from"./Tw41aoDi.js";const _e=r=>{if(r.target===r.currentTarget)return!1;const e=r.target.type;return["textarea","text","date","datetime-local","email","password"].includes(e)},pe=(r,e)=>e.key.toLowerCase()===r.key.toLowerCase()&&!!e.alt===r.altKey&&!!e.ctrl===r.ctrlKey&&!!e.shift===r.shiftKey&&!!e.meta===r.metaKey,ce=globalThis.navigator&&/Mac(intosh|Intel)/.test(globalThis.navigator.userAgent),Re={ArrowDown:"↓",ArrowLeft:"←",ArrowRight:"→",ArrowUp:"↑",Delete:"⌦"},Ve=({alt:r,meta:e,ctrl:a,shift:t,key:d})=>{const n=[];return r&&n.push(ce?"⌥":"Alt"),e&&n.push(ce?"⌘":"❖"),a&&n.push("Ctrl"),t&&n.push("⇧"),n.push(Re[d]??d.toUpperCase()),n},ye=(r,e)=>{function a(t){const d=_e(t);for(const{shortcut:n,onShortcut:P,ignoreInputFields:h=!0,preventDefault:C=!0}of e)if(!(h&&d)&&pe(t,n)){C&&t.preventDefault(),P(t);return}}return r.addEventListener("keydown",a),{update(t){e=t},destroy(){r.removeEventListener("keydown",a)}}};var We=x("<kbd><!></kbd>");function Ne(r,e){W(e,!0);const a=oe(e,"size",3,"small"),t=ke(e,["$$slots","$$events","$$legacy","class","size","children"]),d=Ce({base:"bg-subtle rounded-md border border-b-2 px-1 py-0.5 font-mono shadow",variants:{size:{tiny:"text-xs",small:"text-sm",medium:"text-base",large:"text-lg",giant:"text-xl"}}});var n=We();Ie(n,h=>({class:h,...t}),[()=>he(d({size:a()}),e.class)]);var P=f(n);ge(P,()=>e.children??ue),c(n),o(r,n),N()}var Ge=x('<div class="mt-2"><!></div>'),Je=x('<div class="flex justify-end"><!></div>'),Xe=x('<div class="flex shrink-0 flex-col justify-end gap-1"></div>'),Ye=x('<div class="flex flex-col"><div class="flex place-items-center gap-2"><!> <!></div> <!> <!></div> <!>',1),Ze=x('<div class="p-1"><!></div>');function et(r,e){W(e,!0);const t=(e.item.shortcuts===void 0?[]:Array.isArray(e.item.shortcuts)?e.item.shortcuts:[e.item.shortcuts]).map(h=>Ve(h));let d=re(null);se(()=>{e.selected&&i(d)&&i(d).scrollIntoView({block:"nearest",inline:"start",behavior:"smooth"})});var n=Ze(),P=f(n);{let h=V(()=>e.selected?"outline":"ghost"),C=V(()=>e.selected?"border-primary/50 bg-primary-50":"border-light-200 dark:border-light-300");ze(P,{onclick:()=>e.onSelect(),fullWidth:!0,get variant(){return i(h)},color:"secondary",get class(){return`hover:bg-primary-50 flex justify-between gap-3 border py-4 text-start ${i(C)??""}`},children:(y,G)=>{var J=Ye(),q=Z(J),Q=f(q),ee=f(Q);K(ee,{fontWeight:"semi-bold",children:(s,m)=>{I();var l=M();z(()=>A(l,e.item.title)),o(s,l)},$$slots:{default:!0}});var j=_(ee,2);{var te=s=>{R(s,{get icon(){return e.item.icon},size:"1.25rem",get class(){return e.item.iconClass}})};$(j,s=>{e.item.icon&&s(te)})}c(Q);var w=_(Q,2);{var L=s=>{K(s,{size:"small",class:"mt-0.5 line-clamp-4 w-full overflow-hidden text-ellipsis md:line-clamp-2",color:"muted",children:(m,l)=>{I();var u=M();z(()=>A(u,e.item.description)),o(m,u)},$$slots:{default:!0}})};$(w,s=>{e.item.description&&s(L)})}var D=_(w,2);{var B=s=>{var m=Ge(),l=f(m);je(l,{color:"primary",size:"small",shape:"round",children:(u,g)=>{I();var v=M();z(()=>A(v,e.item.type)),o(u,v)},$$slots:{default:!0}}),c(m),o(s,m)};$(D,s=>{e.item.type&&s(B)})}c(q);var k=_(q,2);{var b=s=>{var m=Xe();fe(m,21,()=>t,l=>l.join("-"),(l,u)=>{var g=Je(),v=f(g);{let p=V(()=>he(e.selected&&"border"));Ne(v,{size:"tiny",get class(){return i(p)},children:(T,ae)=>{I();var E=M();z(U=>A(E,U),[()=>i(u).join(" ")]),o(T,E)},$$slots:{default:!0}})}c(g),o(l,g)}),c(m),o(s,m)};$(k,s=>{t.length>0&&s(b)})}o(y,J)},$$slots:{default:!0}})}c(n),Pe(n,h=>H(d,h),()=>i(d)),o(r,n),N()}function tt(r,e){W(e,!0),qe(r,{get for(){return le.Modal},get as(){return le.ModalHeader},children:(a,t)=>{var d=me(),n=Z(d);ge(n,()=>e.children??ue),o(a,d)},$$slots:{default:!0}}),N()}var rt=x('<div class="flex place-items-center gap-1"><!> <div><!></div></div>'),at=x('<div class="flex flex-col"></div>'),st=x("<!> <!>",1),ot=x('<div class="flex place-items-center gap-1"><span class="flex gap-1 rounded bg-gray-300 p-1 dark:bg-gray-500"><!></span> <!></div>'),nt=x('<div class="flex gap-4"><div class="flex place-items-center gap-1"><span class="rounded bg-gray-300 p-1 dark:bg-gray-500"><!></span> <!></div> <div class="flex place-items-center gap-1"><span class="flex gap-1 rounded bg-gray-300 p-1 dark:bg-gray-500"><!> <!></span> <!></div> <div class="flex place-items-center gap-1"><span class="rounded bg-gray-300 p-1 dark:bg-gray-500"><!></span> <!></div></div>'),lt=x('<div class="flex w-full justify-around"><!></div>'),it=x("<!> <!> <!>",1);function dt(r,e){W(e,!0);const a=oe(e,"initialQuery",3,""),t=y=>P(y,"up"),d=y=>P(y,"down"),n=y=>P(y,"select"),P=async(y,G)=>{switch(y.preventDefault(),G){case"up":{H(h,Math.max((i(h)===0?S.items.length:i(h))-1,0),!0);break}case"down":{if(!i(C)&&S.items.length===0){S.loadAllItems();break}H(h,(i(h)+1)%S.items.length||0,!0);break}case"select":{e.onClose(S.items[i(h)]);break}}};let h=re(0),C=re(ve(a()));se(()=>S.queryUpdate(i(C))),Se(we,(y,G)=>ye?.(y,G),()=>[{shortcut:{key:"ArrowUp"},preventDefault:!1,ignoreInputFields:!1,onShortcut:t},{shortcut:{key:"ArrowDown"},preventDefault:!1,ignoreInputFields:!1,onShortcut:d},{shortcut:{key:"k",ctrl:!0},ignoreInputFields:!1,onShortcut:t},{shortcut:{key:"k",meta:!0},ignoreInputFields:!1,onShortcut:t},{shortcut:{key:"j",ctrl:!0},ignoreInputFields:!1,onShortcut:d},{shortcut:{key:"j",meta:!0},ignoreInputFields:!1,onShortcut:d},{shortcut:{key:"Enter"},ignoreInputFields:!1,onShortcut:n}]),Te(r,{size:"large",get onClose(){return e.onClose},closeOnBackdropClick:!0,class:"max-h-[85vh] lg:max-h-[75vh]",children:(y,G)=>{var J=it(),q=Z(J);tt(q,{children:(j,te)=>{var w=rt(),L=f(w);{let k=V(()=>O("search_placeholder",e.translations));Le(L,{get placeholder(){return i(k)},get leadingIcon(){return Ae},tabindex:1,get value(){return i(C)},set value(b){H(C,b,!0)}})}var D=_(L,2),B=f(D);Me(B,{onclick:()=>e.onClose(),class:"md:hidden"}),c(D),c(w),o(j,w)},$$slots:{default:!0}});var Q=_(q,2);Ue(Q,{children:(j,te)=>{Qe(j,{gap:2,children:(w,L)=>{var D=st(),B=Z(D);{var k=l=>{var u=me(),g=Z(u);{var v=p=>{K(p,{children:(T,ae)=>{I();var E=M();z(U=>A(E,U),[()=>O("search_no_results",e.translations)]),o(T,E)},$$slots:{default:!0}})};$(g,p=>{S.items.length===0&&p(v)})}o(l,u)},b=l=>{K(l,{children:(u,g)=>{I();var v=M();z(p=>A(v,p),[()=>O("command_palette_prompt_default",e.translations)]),o(u,v)},$$slots:{default:!0}})};$(B,l=>{i(C)?l(k):l(b,!1)})}var s=_(B,2);{var m=l=>{var u=at();fe(u,23,()=>S.items,g=>g.id,(g,v,p)=>{{let T=V(()=>i(h)===i(p));et(g,{get item(){return i(v)},get selected(){return i(T)},onSelect:()=>e.onClose(i(v))})}}),c(u),o(l,u)};$(s,l=>{S.items.length>0&&l(m)})}o(w,D)},$$slots:{default:!0}})},$$slots:{default:!0}});var ee=_(Q,2);Oe(ee,{children:(j,te)=>{var w=lt(),L=f(w);{var D=k=>{var b=ot(),s=f(b),m=f(s);R(m,{get icon(){return ie},size:"1rem"}),c(s);var l=_(s,2);K(l,{size:"small",children:(u,g)=>{I();var v=M();z(p=>A(v,p),[()=>O("command_palette_to_show_all",e.translations)]),o(u,v)},$$slots:{default:!0}}),c(b),o(k,b)},B=k=>{var b=nt(),s=f(b),m=f(s),l=f(m);R(l,{get icon(){return De},size:"1rem"}),c(m);var u=_(m,2);K(u,{size:"small",children:(X,ne)=>{I();var F=M();z(Y=>A(F,Y),[()=>O("command_palette_to_select",e.translations)]),o(X,F)},$$slots:{default:!0}}),c(s);var g=_(s,2),v=f(g),p=f(v);R(p,{get icon(){return Be},size:"1rem"});var T=_(p,2);R(T,{get icon(){return ie},size:"1rem"}),c(v);var ae=_(v,2);K(ae,{size:"small",children:(X,ne)=>{I();var F=M();z(Y=>A(F,Y),[()=>O("command_palette_to_navigate",e.translations)]),o(X,F)},$$slots:{default:!0}}),c(g);var E=_(g,2),U=f(E),be=f(U);R(be,{get icon(){return Ee},size:"1rem"}),c(U);var xe=_(U,2);K(xe,{size:"small",children:(X,ne)=>{I();var F=M();z(Y=>A(F,Y),[()=>O("command_palette_to_close",e.translations)]),o(X,F)},$$slots:{default:!0}}),c(E),c(b),o(k,b)};$(L,k=>{!i(C)&&S.items.length===0?k(D):k(B,!1)})}c(w),o(j,w)},$$slots:{default:!0}}),o(y,J)},$$slots:{default:!0}}),N()}const ct=({name:r,actions:e})=>({name:r,onSearch:a=>a?e.filter(t=>$e(t).includes(a.toLowerCase())):e});class ut{#s={};#e=[];#r=!1;#a=!1;#t=re(ve([]));get isEnabled(){return this.#r}get items(){return i(this.#t)}enable(){this.#r||(this.#r=!0,globalThis.window&&document.body&&(ye(document.body,[{shortcut:{key:"k",meta:!0},onShortcut:()=>this.open()},{shortcut:{key:"k",ctrl:!0},onShortcut:()=>this.open()},{shortcut:{key:"/"},preventDefault:!0,onShortcut:()=>this.open()}]),document.body.addEventListener("keydown",e=>this.#n(e))))}setTranslations(e={}){this.#s=e}async#o(e){const a=await Promise.all(this.#e.map(t=>Promise.resolve(t.onSearch(e))));H(this.#t,a.flat().filter(t=>de(t)).map(t=>({...t,id:Fe()})),!0)}queryUpdate(e){if(!e){H(this.#t,[],!0);return}this.#o(e)}async#n(e){const a=await Promise.all(this.#e.map(t=>Promise.resolve(t.onSearch())));for(const t of a.flat()){if(!Ke(t.shortcuts).some(P=>pe(e,P))||!de(t))continue;const{ignoreInputFields:d=!0,preventDefault:n=!0}=t.shortcutOptions||{};d&&_e(e)||(n&&e.preventDefault(),t?.onAction(t))}}async#l(e){await e?.onAction(e),this.#a=!1,H(this.#t,[],!0)}open(e){if(this.#a)return;const{onClose:a}=He.open(dt,{translations:this.#s,initialQuery:e});this.#a=!0,a.then(t=>this.#l(t))}loadAllItems(){this.#o()}addProvider(e){return this.#e.push(e),()=>this.#i(e)}#i(e){this.#e=this.#e.filter(a=>a!==e)}}const S=new ut;function vt(r,e){W(e,!0),se(()=>{const a=[];for(const t of e.providers)a.push(S.addProvider(t));return()=>a.forEach(t=>t())}),N()}function It(r,e){W(e,!0);const a=oe(e,"actions",19,()=>[]);{let t=V(()=>[ct({name:e.name,actions:a()})]);vt(r,{get providers(){return i(t)}})}N()}export{It as C,S as c};
