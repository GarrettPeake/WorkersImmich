import{a as We,p as Je,u as Ne}from"../chunks/CJGyQpNN.js";import{g as qe,$ as ue}from"../chunks/DWQ0JXRY.js";import"../chunks/DsnmJJEf.js";import{p as re,f as C,g as e,a as ne,b as He,u as m,s as c,t as ae,j as O,c as N,h as q,r as z}from"../chunks/D0CSSuTl.js";import{c as Y,a as h,f as L}from"../chunks/Bd1JH_Ov.js";import{i as b}from"../chunks/D8NIUdeB.js";import{p as Z,c as Ke,s as ve,a as B}from"../chunks/zonMEKN6.js";import{b as Ge}from"../chunks/gvLJu3l0.js";import{U as Qe}from"../chunks/tK_U6--f.js";import{B as xe}from"../chunks/GXf5CvES.js";import{E as Xe}from"../chunks/BcC-f0mZ.js";import{C as Ye,A as Se}from"../chunks/BLnXPQ5q.js";import{F as Ze,A as et}from"../chunks/CQ8X2sVV.js";import{A as tt}from"../chunks/BmVzuLMt.js";import{C as st,a as at}from"../chunks/DmzJz26a.js";import{C as ot,T as rt}from"../chunks/Buf2v_0r.js";import{D as nt}from"../chunks/DpocfqHG.js";import{D as Ce}from"../chunks/vBkll8cH.js";import{g as De,A as it}from"../chunks/CfdSAoAU.js";import{a as lt}from"../chunks/DxRnQWdm.js";import{e as ct,h as Le}from"../chunks/DLePdI2u.js";import{t as X,g as mt}from"../chunks/CF_nq223.js";import{R as Me,h as dt,n as ut}from"../chunks/BP6NvnZ7.js";import{p as vt,i as ft,q as ce,s as me,cJ as Pe,I as oe,cK as gt,F as Te,ad as Ve,bR as pt,l as Ue,cL as ht,aI as _t,a3 as At,ak as kt,cM as bt,ag as yt,ah as It}from"../chunks/D-UYCH9y.js";import{M as de}from"../chunks/B2VKg7zy.js";import{S as wt}from"../chunks/C9R8P1Xg.js";import{S as $t}from"../chunks/BL72B9yC.js";import{a9 as xt,aa as St,y as Ct,ab as Lt}from"../chunks/DUXNbmIP.js";import{T as Mt}from"../chunks/BaHAZRvh.js";import{A as Pt}from"../chunks/0qPXRVhz.js";import"../chunks/CG4KAGH3.js";import{R as Tt}from"../chunks/gegweU97.js";import{A as Vt}from"../chunks/MMtgDOP-.js";import{a as Ut}from"../chunks/Cr9S0fVn.js";import{i as Rt}from"../chunks/BmJQ54Se.js";import{m as Dt}from"../chunks/DfiAe9j-.js";import{u as Ot,b as Ft}from"../chunks/ChL-L15l.js";import{o as jt}from"../chunks/WQ1yKytR.js";import{e as Bt,s as Et}from"../chunks/C8vxa4mj.js";import{s as zt}from"../chunks/CMI33r64.js";import{b as Re}from"../chunks/Dgf_MdoC.js";const Wt=(w,t=He)=>{var n=Jt(),$=N(n),M=c($,4),d=N(M,!0);z(M),z(n),ae(()=>{me(n,"href",t().href),me($,"src",t().src),me($,"alt",t().alt??t().title),Et(d,t().title)}),h(w,n)};var Jt=L('<a class="item-card relative me-2 inline-block aspect-3/4 h-54 rounded-xl last:me-0 max-md:h-37.5 md:me-4 md:aspect-4/3 xl:aspect-video svelte-bjvu5t"><img class="h-full w-full rounded-xl object-cover" draggable="false"/> <div class="absolute start-0 top-0 h-full w-full rounded-xl bg-linear-to-t from-black/40 via-transparent to-transparent transition-all hover:bg-black/20"></div> <p class="absolute start-4 bottom-2 text-lg text-white max-md:text-sm"> </p></a>'),Nt=L('<div class="light absolute start-4 top-27 -translate-y-1/2 max-md:top-19"><!></div>'),qt=L("<div><!></div>"),Ht=L("<div><!> <!></div>"),Kt=L('<section style="scrollbar-width:none"><!> <div class="inline-block"></div></section>');function Gt(w,t){re(t,!0);const n=Z(t,"scrollBy",3,400),$=Z(t,"child",3,Wt);let M=m(()=>t.items.length>0),d=q(void 0),x=q(0),k=q(0),_=q(0),V=m(()=>e(_)>0),P=m(()=>Math.ceil(e(_))<Math.floor(e(k)-e(x)));const r=()=>{O(_,e(d)?.scrollLeft??0,!0)},F=()=>e(d)?.scrollBy({left:-n(),behavior:"smooth"}),i=()=>e(d)?.scrollBy({left:n(),behavior:"smooth"});var a=Y(),v=C(a);{var U=R=>{var S=Kt(),W=N(S);{var l=s=>{var A=Ht(),T=N(A);{var y=g=>{var p=Nt(),I=N(p);{let D=m(()=>Ue("navigate_previous",t.translations));oe(I,{get icon(){return gt},shape:"round",variant:"outline",color:"secondary",class:"opacity-50 hover:opacity-100",size:"giant",get"aria-label"(){return e(D)},onclick:F})}z(p),Te(3,p,()=>Ve,()=>({duration:200})),h(g,p)};b(T,g=>{e(V)&&g(y)})}var H=c(T,2);{var o=g=>{var p=qt(),I=N(p);{let D=m(()=>Ue("navigate_next",t.translations));oe(I,{get icon(){return pt},shape:"round",variant:"outline",color:"secondary",class:"opacity-50 hover:opacity-100",size:"giant",get"aria-label"(){return e(D)},onclick:i})}z(p),ae(()=>ce(p,1,`light absolute end-4 top-27 ${Pe.CarouselImage} -translate-y-1/2 max-md:top-19`,"svelte-bjvu5t")),Te(3,p,()=>Ve,()=>({duration:200})),h(g,p)};b(H,g=>{e(P)&&g(o)})}z(A),ae(()=>ce(A,1,`sticky start-0 ${Pe.CarouselImage}`,"svelte-bjvu5t")),h(s,A)};b(W,s=>{(e(V)||e(P))&&s(l)})}var f=c(W,2);ct(f,23,()=>t.items,(s,A)=>s.id??A,(s,A)=>{var T=Y(),y=C(T);zt(y,$,()=>e(A)),h(s,T)}),z(f),z(S),Ke(S,s=>O(d,s),()=>e(d)),ae(s=>ce(S,1,s,"svelte-bjvu5t"),[()=>vt(ft("relative mt-3 overflow-x-scroll overflow-y-hidden whitespace-nowrap transition-all",t.class))]),Bt("scroll",S,r),Re(f,"clientWidth",s=>O(k,s)),Re(S,"clientWidth",s=>O(x,s)),h(R,S)};b(v,R=>{e(M)&&R(U)})}h(w,a),ne()}const Qt=(async({url:w})=>(await We(w),{meta:{title:(await qe())("photos")}})),qs=Object.freeze(Object.defineProperty({__proto__:null,load:Qt},Symbol.toStringTag,{value:"Module"}));var Xt=L("<!> <!>",1);function Yt(w,t){re(t,!0);const n=()=>B(ue,"$t",$),[$,M]=ve();let d=Z(t,"menuItem",3,!1),x=Z(t,"unlink",3,!1),k=q(!1),_=m(()=>x()?n()("unlink_motion_video"):n()("link_motion_video")),V=m(()=>x()?ht:_t);const{clearSelect:P,getOwnedAssets:r}=De(),F=()=>x()?a():i(),i=async()=>{let[l,f]=[...r()];l.isVideo&&([l,f]=[f,l]);try{O(k,!0);const s=await Me({id:l.id,updateAssetDto:{livePhotoVideoId:f.id}});t.onLink({still:X(s),motion:f}),P()}catch(s){Le(s,n()("errors.unable_to_link_motion_video"))}finally{O(k,!1)}},a=async()=>{const[l]=[...r()];if(!l)return;const f=l.livePhotoVideoId;if(f)try{O(k,!0);const s=await Me({id:l.id,updateAssetDto:{livePhotoVideoId:null}}),A=await dt({...lt.params,id:f});t.onUnlink({still:X(s),motion:X(A)}),P()}catch(s){Le(s,n()("errors.unable_to_unlink_motion_video"))}finally{O(k,!1)}};var v=Xt(),U=C(v);{var R=l=>{de(l,{get text(){return e(_)},get icon(){return e(V)},onClick:F})};b(U,l=>{d()&&l(R)})}var S=c(U,2);{var W=l=>{var f=Y(),s=C(f);{var A=y=>{{let H=m(()=>n()("loading"));oe(y,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(H)},get icon(){return At},onclick:()=>{}})}},T=y=>{oe(y,{shape:"round",color:"secondary",variant:"ghost",get"aria-label"(){return e(_)},get icon(){return e(V)},onclick:F})};b(s,y=>{e(k)?y(A):y(T,!1)})}h(l,f)};b(S,l=>{d()||l(W)})}h(w,v),ne(),M()}function Zt(w,t){re(t,!0);const n=()=>B(ue,"$t",$),[$,M]=ve();let d=Z(t,"unstack",3,!1);const{clearSelect:x,getOwnedAssets:k}=De(),_=async()=>{const a=[...k()],v=await St(a);t.onStack?.(v),x()},V=async()=>{const a=[...k()];if(a.length!==1)return;const{stack:v}=a[0];if(!v)return;const U=await xt([v.id]);U&&t.onUnstack?.(U.map(R=>X(R))),x()};var P=Y(),r=C(P);{var F=a=>{{let v=m(()=>n()("unstack"));de(a,{get text(){return e(v)},get icon(){return kt},onClick:V})}},i=a=>{{let v=m(()=>n()("stack"));de(a,{get text(){return e(v)},get icon(){return bt},onClick:_})}};b(r,a=>{d()?a(F):a(i,!1)})}h(w,P),ne(),M()}var es=L("<!> <!>",1),ts=L("<!> <!> <!> <!> <!> <!> <!> <!> <!> <!> <hr/> <!>",1),ss=L("<!> <!>",1),as=L("<!> <!> <!> <!>",1),os=L("<!> <!>",1);function Hs(w,t){re(t,!0);const n=()=>B(Ne,"$user",_),$=()=>B(P,"$showAssetViewer",_),M=()=>B(Lt,"$memoryLaneTitle",_),d=()=>B(ue,"$t",_),x=()=>B(mt,"$getAltText",_),k=()=>B(Je,"$preferences",_),[_,V]=ve();let{isViewing:P}=Ut,r=q(void 0);const F={visibility:ut.Timeline,withStacked:!0,withPartners:!0},i=new Vt;let a=m(()=>i.selectedAssets),v=m(()=>e(a).length===1&&!!e(a)[0].stack),U=m(()=>{const o=e(a).length===1&&!!e(a)[0].livePhotoVideoId,g=e(a).length===2&&e(a).some(p=>p.isImage)&&e(a).some(p=>p.isVideo);return i.isAllUserOwned&&(o||g)});const R=m(()=>n()&&e(a).every(o=>o.ownerId===n().id)),S=()=>{if(!$()&&i.selectionActive){i.clearMultiselect();return}},W=({still:o,motion:g})=>{e(r).removeAssets([g.id]),e(r).upsertAssets([o])},l=({still:o,motion:g})=>{e(r).upsertAssets([g]),e(r).upsertAssets([o])},f=o=>{e(r).removeAssets(o),i.clearMultiselect()};Ge(()=>{Rt.value=!1});const s=m(()=>Dt.memories.map(o=>({id:o.id,title:M()(o),href:Tt.memories({id:o.assets[0].id}),alt:d()("memory_lane_title",{values:{title:x()(X(o.assets[0]))}}),src:Ct({id:o.assets[0].id})})));var A=os(),T=C(A);Qe(T,{get hideNavbar(){return i.selectionActive},scrollbar:!1,children:(o,g)=>{Mt(o,{enableRouting:!0,get options(){return F},get assetInteraction(){return i},get removeAction(){return Pt.ARCHIVE},onEscape:S,withStacked:!0,get timelineManager(){return e(r)},set timelineManager(I){O(r,I,!0)},empty:I=>{{let D=m(()=>d()("no_assets_message"));Xe(I,{get text(){return e(D)},onClick:()=>jt(),class:"mt-10 mx-auto"})}},children:(I,D)=>{var K=Y(),ee=C(K);{var ie=G=>{Gt(G,{get items(){return e(s)}})};b(ee,G=>{k().memories.enabled&&G(ie)})}h(I,K)},$$slots:{empty:!0,default:!0}})},$$slots:{default:!0}});var y=c(T,2);{var H=o=>{it(o,{get ownerId(){return n().id},get assets(){return i.selectedAssets},clearSelect:()=>i.clearMultiselect(),children:(g,p)=>{var I=as(),D=C(I);Ye(D,{});var K=c(D,2);wt(K,{get timelineManager(){return e(r)},get assetInteraction(){return i}});var ee=c(K,2);{let j=m(()=>d()("add_to"));xe(ee,{get icon(){return yt},get title(){return e(j)},children:(te,le)=>{var se=es(),J=C(se);Se(J,{});var Q=c(J,2);Se(Q,{shared:!0}),h(te,se)},$$slots:{default:!0}})}var ie=c(ee,2);{var G=j=>{var te=ss(),le=C(te);Ze(le,{get removeFavorite(){return i.isAllFavorite},onFavorite:(J,Q)=>e(r).update(J,fe=>fe.isFavorite=Q)});var se=c(le,2);{let J=m(()=>d()("menu"));xe(se,{get icon(){return It},get title(){return e(J)},children:(Q,fe)=>{var ge=ts(),pe=C(ge);Ce(pe,{menuItem:!0});var he=c(pe,2);{var Fe=u=>{Zt(u,{get unstack(){return e(v)},onStack:E=>Ft(e(r),E),onUnstack:E=>Ot(e(r),E)})};b(he,u=>{(i.selectedAssets.length>1||e(v))&&u(Fe)})}var _e=c(he,2);{var je=u=>{{let E=m(()=>i.selectedAssets.length===1);Yt(u,{menuItem:!0,get unlink(){return e(E)},onLink:W,onUnlink:l})}};b(_e,u=>{e(U)&&u(je)})}var Ae=c(_e,2);st(Ae,{menuItem:!0});var ke=c(Ae,2);ot(ke,{menuItem:!0});var be=c(ke,2);at(be,{menuItem:!0});var ye=c(be,2);et(ye,{menuItem:!0,onArchive:(u,E)=>e(r).update(u,ze=>ze.visibility=E)});var Ie=c(ye,2);{var Be=u=>{rt(u,{menuItem:!0})};b(Ie,u=>{k().tags.enabled&&u(Be)})}var we=c(Ie,2);nt(we,{menuItem:!0,onAssetDelete:u=>e(r).removeAssets(u),onUndoDelete:u=>e(r).upsertAssets(u)});var $e=c(we,2);$t($e,{menuItem:!0,onVisibilitySet:f});var Ee=c($e,4);tt(Ee,{}),h(Q,ge)},$$slots:{default:!0}})}h(j,te)},Oe=j=>{Ce(j,{})};b(ie,j=>{e(R)?j(G):j(Oe,!1)})}h(g,I)},$$slots:{default:!0}})};b(y,o=>{i.selectionActive&&o(H)})}h(w,A),ne(),V()}export{Hs as component,qs as universal};
