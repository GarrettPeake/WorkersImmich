import{a as lt}from"../chunks/CJGyQpNN.js";import{g as ct,$ as at}from"../chunks/DWQ0JXRY.js";import"../chunks/DsnmJJEf.js";import{p as st,g as e,a as rt,f as X,c as x,r as y,s as $,t as _,u as D,h as N,i as dt,b as ut,j as U,$ as Y,n as w}from"../chunks/D0CSSuTl.js";import{s as m,e as Z}from"../chunks/C8vxa4mj.js";import{a as c,f as O,c as mt,t as C}from"../chunks/Bd1JH_Ov.js";import{i as tt}from"../chunks/D8NIUdeB.js";import{s as nt,a as it}from"../chunks/zonMEKN6.js";import{U as pt}from"../chunks/tK_U6--f.js";import{C as gt}from"../chunks/BVcN3VUI.js";import{E as ft}from"../chunks/BcC-f0mZ.js";import{T as _t}from"../chunks/BaHAZRvh.js";import{A as vt}from"../chunks/0qPXRVhz.js";import{s as $t,a as ht}from"../chunks/DxRnQWdm.js";import{t as xt}from"../chunks/CF_nq223.js";import{n as yt,k as bt,h as kt}from"../chunks/BP6NvnZ7.js";import{e as et}from"../chunks/DUXNbmIP.js";import{C as At,m as ot}from"../chunks/BHTYC334.js";import{A as wt}from"../chunks/MMtgDOP-.js";import{T as E,B as W,bm as Ct,a6 as Mt,bn as Pt}from"../chunks/D-UYCH9y.js";const Tt=(async({url:M})=>(await lt(M),{meta:{title:(await ct())("manage_geolocation")}})),oe=Object.freeze(Object.defineProperty({__proto__:null,load:Tt},Symbol.toStringTag,{value:"Module"}));var It=O("<p> </p> <p> </p> <p> </p>",1);function St(M,g){st(g,!0);const i=()=>it(at,"$t",F),[F,L]=nt();{const o=P=>{var b=It(),T=X(b),R=x(T,!0);y(T);var I=$(T,2),V=x(I);y(I);var S=$(I,2),K=x(S);y(S),_((G,j,H)=>{m(R,G),m(V,`- ${j??""}: ${g.location.latitude??""}`),m(K,`- ${H??""}: ${g.location.longitude??""}`)},[()=>i()("update_location_action_prompt",{values:{count:g.assetCount}}),()=>i()("latitude"),()=>i()("longitude")]),c(P,b)};let d=D(()=>i()("confirm"));At(M,{get title(){return e(d)},size:"small",confirmColor:"primary",get onClose(){return g.onClose},prompt:o,$$slots:{prompt:!0}})}rt(),L()}var zt=O('<div class="flex gap-2 justify-end place-items-center"><!> <div class="border flex place-items-center place-content-center px-2 py-1 bg-primary/10 rounded-2xl"><!> <!></div> <!> <!> <!></div>'),Ut=O('<div class="absolute bottom-1 end-3 px-4 py-1 rounded-xl text-xs transition-colors bg-success text-black"> </div>'),Et=O('<div class="absolute bottom-1 end-3 px-4 py-1 rounded-xl text-xs transition-colors bg-danger text-light"> </div>'),Dt=O("<!> <!>",1);function ae(M,g){st(g,!0);const i=()=>it(at,"$t",F),[F,L]=nt();let o=new wt,d=N(dt({latitude:0,longitude:0})),P=N(!1),b=N(void 0);const T={visibility:yt.Timeline,withStacked:!0,withPartners:!0,withCoordinates:!0},R=async()=>{if(!await ot.show(St,{location:e(d)??{latitude:0,longitude:0},assetCount:o.selectedAssets.length}))return;await bt({assetBulkUpdateDto:{ids:o.selectedAssets.map(u=>u.id),latitude:e(d)?.latitude??void 0,longitude:e(d)?.longitude??void 0}});const h=await Promise.all(o.selectedAssets.map(async u=>{const f=await kt({...ht.params,id:u.id});return xt(f)}));e(b).upsertAssets(h),S()},I=t=>{t.key==="Shift"&&t.preventDefault(),t.key==="Escape"&&o.selectionActive&&et(o)},V=t=>{t.key==="Shift"&&t.preventDefault()},S=()=>{et(o)},K=async()=>{const t=await ot.show(gt,{point:{lat:e(d).latitude,lng:e(d).longitude}});t&&U(d,{latitude:t.lat,longitude:t.lng},!0)},G=()=>{if(o.selectionActive){o.clearMultiselect();return}},j=t=>!!t.latitude&&!!t.longitude,H=(t,h,u,f)=>{j(t)?(U(P,!0),setTimeout(()=>{U(P,!1)},1500),U(d,{latitude:t.latitude,longitude:t.longitude},!0),$t("at",t.id)):f(h,u.getAssets(),u.groupTitle,t)};Z("keydown",Y,I),Z("keyup",Y,V),pt(M,{get title(){return g.data.meta.title},scrollbar:!0,buttons:h=>{var u=zt(),f=x(u);E(f,{class:"hidden md:block mr-4",size:"tiny",color:"muted",children:(a,p)=>{w();var l=C();_(s=>m(l,s),[()=>i()("geolocation_instruction_location")]),c(a,l)},$$slots:{default:!0}});var k=$(f,2),B=x(k);E(B,{class:"hidden md:inline-block font-mono mr-5 ml-2",color:"muted",size:"tiny",children:(a,p)=>{w();var l=C();_(s=>m(l,s),[()=>i()("selected_gps_coordinates")]),c(a,l)},$$slots:{default:!0}});var Q=$(B,2);{let a=D(()=>e(P)?"bg-primary/90 text-light font-semibold scale-105":"");E(Q,{title:"latitude, longitude",get class(){return`rounded-3xl font-mono text-sm text-primary px-2 py-1 transition-all duration-100 ease-in-out ${e(a)??""}`},children:(p,l)=>{w();var s=C();_((r,n)=>m(s,`${r??""}, ${n??""}`),[()=>e(d).latitude.toFixed(3),()=>e(d).longitude.toFixed(3)]),c(p,s)},$$slots:{default:!0}})}y(k);var q=$(k,2);W(q,{size:"small",color:"secondary",variant:"ghost",get leadingIcon(){return Ct},onclick:K,children:(a,p)=>{E(a,{class:"hidden sm:inline-block",children:(l,s)=>{w();var r=C();_(n=>m(r,n),[()=>i()("location_picker_choose_on_map")]),c(l,r)},$$slots:{default:!0}})},$$slots:{default:!0}});var v=$(q,2);{let a=D(()=>!o.selectionActive);W(v,{get leadingIcon(){return Mt},size:"small",color:"secondary",variant:"ghost",get disabled(){return e(a)},onclick:S,children:(p,l)=>{w();var s=C();_(r=>m(s,r),[()=>i()("unselect_all")]),c(p,s)},$$slots:{default:!0}})}var A=$(v,2);{let a=D(()=>o.selectedAssets.length===0);W(A,{get leadingIcon(){return Pt},size:"small",color:"primary",get disabled(){return e(a)},onclick:()=>R(),children:(p,l)=>{E(p,{class:"hidden sm:inline-block",children:(s,r)=>{w();var n=C();_(z=>m(n,z),[()=>i()("apply_count",{values:{count:o.selectedAssets.length}})]),c(s,n)},$$slots:{default:!0}})},$$slots:{default:!0}})}y(u),c(h,u)},children:(h,u)=>{var f=Dt(),k=X(f);tt(k,Q=>{});var B=$(k,2);_t(B,{isSelectionMode:!0,enableRouting:!0,get options(){return T},get assetInteraction(){return o},get removeAction(){return vt.ARCHIVE},onEscape:G,withStacked:!0,onThumbnailClick:H,get timelineManager(){return e(b)},set timelineManager(v){U(b,v,!0)},customThumbnailLayout:(v,A=ut)=>{var a=mt(),p=X(a);{var l=r=>{var n=Ut(),z=x(n,!0);y(n),_(J=>m(z,J),[()=>A().city||i()("gps")]),c(r,n)},s=r=>{var n=Et(),z=x(n,!0);y(n),_(J=>m(z,J),[()=>i()("gps_missing")]),c(r,n)};tt(p,r=>{j(A())?r(l):r(s,!1)})}c(v,a)},empty:v=>{{let A=D(()=>i()("no_assets_message"));ft(v,{get text(){return e(A)},onClick:()=>{},class:"mt-10 mx-auto"})}},$$slots:{customThumbnailLayout:!0,empty:!0}}),c(h,f)},$$slots:{buttons:!0,default:!0}}),rt(),L()}export{ae as component,oe as universal};
