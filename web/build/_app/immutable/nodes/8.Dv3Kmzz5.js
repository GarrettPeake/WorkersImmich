import{a as yt,r as Lt}from"../chunks/CJGyQpNN.js";import{g as Ut,$ as Ct}from"../chunks/DWQ0JXRY.js";import{w as At,x as St,y as ut,z as Tt,B as kt}from"../chunks/BP6NvnZ7.js";import"../chunks/DsnmJJEf.js";import{p as jt,h as Dt,i as J,f as E,g as t,a as Et,j as Ot,s as n,u as o,b as zt,c as Bt,t as f,n as p,r as Ft}from"../chunks/D0CSSuTl.js";import{s as g}from"../chunks/C8vxa4mj.js";import{s as It}from"../chunks/CMI33r64.js";import{i as Mt}from"../chunks/D8NIUdeB.js";import{e as Rt}from"../chunks/DLePdI2u.js";import{a as s,t as v,c as Ht,f as O}from"../chunks/Bd1JH_Ov.js";import{F as Wt,ad as qt,ae as Gt}from"../chunks/D-UYCH9y.js";import{s as Jt,a as it}from"../chunks/zonMEKN6.js";import{g as ct}from"../chunks/gvLJu3l0.js";import{A as Kt}from"../chunks/CaRu5ymf.js";import{O as Nt}from"../chunks/Cq6696VF.js";import{E as Qt}from"../chunks/BcC-f0mZ.js";import{R as M}from"../chunks/gegweU97.js";import{g as Vt,a as Xt}from"../chunks/Bat68L0B.js";import{u as Yt,l as Zt}from"../chunks/DUXNbmIP.js";import{C as te}from"../chunks/CG2BHJh0.js";import{C as ee}from"../chunks/cX31cXxY.js";import{T as re,a as se,b as U,c as ae,d as oe,e as C}from"../chunks/B5_uSbnk.js";import{L as dt}from"../chunks/CTSOIQJr.js";import{C as le}from"../chunks/DCkJo5DD.js";const ne=(async({url:R})=>{await yt(R,{admin:!0}),await Lt();const w=await At({withDeleted:!1}),i=await Ut(),P=await St(),z=await Promise.all(P.map(async({id:c})=>[c,await ut({id:c})])),H=await Promise.all(P.map(async({id:c,ownerId:A})=>[c,await Tt({id:A})]));return{allUsers:w,libraries:P,statistics:Object.fromEntries(z),owners:Object.fromEntries(H),meta:{title:i("external_libraries")}}}),Ie=Object.freeze(Object.defineProperty({__proto__:null,load:ne},Symbol.toStringTag,{value:"Module"}));var ie=O("<!> <!> <!> <!> <!> <!>",1),ce=O("<!> <!> <!> <!> <!> <!>",1),de=O("<!> <!>",1),ue=O('<div class="flex flex-col items-center gap-2"><!> <!></div>'),me=O("<!> <!> <!>",1);function Me(R,w){jt(w,!0);const i=()=>it(Ct,"$t",z),P=()=>it(Zt,"$locale",z),[z,H]=Jt();let c=Dt(J(w.data.libraries)),A=J(w.data.statistics),K=J(w.data.owners);const mt=async r=>{await ct(M.viewLibrary(r))},$t=async r=>{const $=t(c).findIndex(({id:S})=>S===r.id);$!==-1&&(t(c)[$]=await kt({id:r.id}),A[r.id]=await ut({id:r.id}))},ft=({id:r})=>{Ot(c,t(c).filter($=>$.id!==r),!0),delete A[r],delete K[r]},N=o(()=>Xt(i(),t(c))),Q=o(()=>t(N).Create),V=o(()=>t(N).ScanAll),pt=r=>{const{Detail:$,Scan:S,Edit:tt,Delete:W}=Vt(i(),r);return[$,S,tt,Gt.Divider,W]},d={column1:"w-4/12",column2:"w-4/12",column3:"w-1/12",column4:"w-1/12",column5:"w-1/12",column6:"w-1/12 flex justify-end"};var X=me(),Y=E(X);Nt(Y,{onLibraryCreate:mt,onLibraryUpdate:$t,onLibraryDelete:ft});var Z=n(Y,2);{let r=o(()=>i()("library")),$=o(()=>[t(Q),t(V)]);te(Z,{get name(){return t(r)},get actions(){return t($)}})}var gt=n(Z,2);{let r=o(()=>[{title:w.data.meta.title}]),$=o(()=>[t(V),t(Q)]);Kt(gt,{get breadcrumbs(){return t(r)},get actions(){return t($)},children:(S,tt)=>{ee(S,{size:"large",center:!0,class:"my-4",children:(W,$e)=>{var B=ue(),et=Bt(B);{var vt=y=>{re(y,{striped:!0,size:"small",spacing:"small",children:(q,fe)=>{var rt=de(),st=E(rt);se(st,{children:(G,bt)=>{var T=ie(),F=E(T);U(F,{get class(){return d.column1},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("name")]),s(a,e)},$$slots:{default:!0}});var x=n(F,2);U(x,{get class(){return d.column2},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("owner")]),s(a,e)},$$slots:{default:!0}});var b=n(x,2);U(b,{get class(){return d.column3},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("photos")]),s(a,e)},$$slots:{default:!0}});var L=n(b,2);U(L,{get class(){return d.column4},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("videos")]),s(a,e)},$$slots:{default:!0}});var k=n(L,2);U(k,{get class(){return d.column5},children:(a,_)=>{p();var e=v();f(u=>g(e,u),[()=>i()("size")]),s(a,e)},$$slots:{default:!0}});var I=n(k,2);U(I,{get class(){return d.column6}}),s(G,T)},$$slots:{default:!0}});var wt=n(st,2);ae(wt,{children:(G,bt)=>{var T=Ht(),F=E(T);Rt(F,17,()=>t(c),x=>x.id+x.name,(x,b)=>{const L=o(()=>{const{photos:a,usage:_,videos:e}=A[t(b).id];return{photos:a,usage:_,videos:e}}),k=o(()=>{const[a,_]=Yt(t(L).usage,0);return{diskUsage:a,diskUsageUnit:_}}),I=o(()=>K[t(b).id]);oe(x,{children:(a,_)=>{var e=ce(),u=E(e);C(u,{get class(){return d.column1},children:(m,j)=>{{let l=o(()=>M.viewLibrary(t(b)));dt(m,{get href(){return t(l)},children:(h,Pt)=>{p();var D=v();f(()=>g(D,t(b).name)),s(h,D)},$$slots:{default:!0}})}},$$slots:{default:!0}});var at=n(u,2);C(at,{get class(){return d.column2},children:(m,j)=>{{let l=o(()=>M.viewUser(t(I)));dt(m,{get href(){return t(l)},children:(h,Pt)=>{p();var D=v();f(()=>g(D,t(I).name)),s(h,D)},$$slots:{default:!0}})}},$$slots:{default:!0}});var ot=n(at,2);C(ot,{get class(){return d.column3},children:(m,j)=>{p();var l=v();f(h=>g(l,h),[()=>t(L).photos.toLocaleString(P())]),s(m,l)},$$slots:{default:!0}});var lt=n(ot,2);C(lt,{get class(){return d.column4},children:(m,j)=>{p();var l=v();f(h=>g(l,h),[()=>t(L).videos.toLocaleString(P())]),s(m,l)},$$slots:{default:!0}});var nt=n(lt,2);C(nt,{get class(){return d.column5},children:(m,j)=>{p();var l=v();f(()=>g(l,`${t(k).diskUsage??""} ${t(k).diskUsageUnit??""}`)),s(m,l)},$$slots:{default:!0}});var xt=n(nt,2);C(xt,{get class(){return d.column6},children:(m,j)=>{{let l=o(()=>i()("open")),h=o(()=>pt(t(b)));le(m,{color:"primary",get"aria-label"(){return t(l)},get items(){return t(h)}})}},$$slots:{default:!0}}),s(a,e)},$$slots:{default:!0}})}),s(G,T)},$$slots:{default:!0}}),s(q,rt)},$$slots:{default:!0}})},_t=y=>{{let q=o(()=>i()("no_libraries_message"));Qt(y,{fullWidth:!0,get text(){return t(q)},onClick:()=>ct(M.newLibrary()),class:"mt-10 mx-auto"})}};Mt(et,y=>{t(c).length>0?y(vt):y(_t,!1)})}var ht=n(et,2);It(ht,()=>w.children??zt),Ft(B),Wt(1,B,()=>qt,()=>({duration:500})),s(W,B)},$$slots:{default:!0}})},$$slots:{default:!0}})}s(R,X),Et(),H()}export{Me as component,Ie as universal};
