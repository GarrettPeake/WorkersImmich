import{a as Le,D as ge}from"../chunks/CJGyQpNN.js";import{g as we,$ as ue}from"../chunks/DWQ0JXRY.js";import"../chunks/DsnmJJEf.js";import{s as U,o as Se}from"../chunks/C8vxa4mj.js";import{p as me,c as y,r as f,a as fe,f as C,g as e,u as i,s as g,t as E,n as ve,h as Ae,i as Ce,j as pe,b as $e}from"../chunks/D0CSSuTl.js";import{i as $}from"../chunks/D8NIUdeB.js";import{e as be,i as Pe}from"../chunks/DLePdI2u.js";import{a,c as se,f as P,t as M}from"../chunks/Bd1JH_Ov.js";import{s as Te}from"../chunks/CMI33r64.js";import{p as xe,s as he,a as le}from"../chunks/zonMEKN6.js";import{g as ze}from"../chunks/gvLJu3l0.js";import{p as De}from"../chunks/CG4KAGH3.js";import{U as Oe}from"../chunks/tK_U6--f.js";import{O as je}from"../chunks/Cq6696VF.js";import{at as Me,h as Ue,T as re,ae as Ee}from"../chunks/D-UYCH9y.js";import{A as ce}from"../chunks/CIJfCxLq.js";import{A as Ie,a as Ne,N as Re}from"../chunks/Cfc6dgin.js";import{y as We,l as Be}from"../chunks/DUXNbmIP.js";import{R as ke}from"../chunks/gegweU97.js";import{b as Ge}from"../chunks/CgXU4mBI.js";import{S as oe,g as Fe}from"../chunks/BP6NvnZ7.js";import{C as qe}from"../chunks/DCkJo5DD.js";import{G as He}from"../chunks/B8xO085N.js";import{C as Je}from"../chunks/cX31cXxY.js";const Ke=(async({url:I})=>(await Le(I),{meta:{title:(await we())("shared_links")}})),Tt=Object.freeze(Object.defineProperty({__proto__:null,load:Ke},Symbol.toStringTag,{value:"Module"}));var Qe=P('<div class="relative shrink-0 size-22"><!></div>');function Ve(I,t){me(t,!0);const p=()=>le(ue,"$t",n),[n,G]=he();let c=xe(t,"preload",3,!1),T=xe(t,"class",3,"");var h=Qe(),L=y(h);{var Y=d=>{Ie(d,{get album(){return t.sharedLink.album},get class(){return T()},get preload(){return c()}})},N=d=>{var R=se(),F=C(R);{var q=u=>{{let D=i(()=>p()("individual_share")),s=i(()=>We({id:t.sharedLink.assets[0].id}));Ne(u,{get alt(){return e(D)},get class(){return T()},get preload(){return c()},get src(){return e(s)}})}},z=u=>{{let D=i(()=>p()("unnamed_share"));Re(u,{get alt(){return e(D)},get class(){return T()},get preload(){return c()}})}};$(F,u=>{t.sharedLink.assets[0]?u(q):u(z,!1)},!0)}a(d,R)};$(L,d=>{t.sharedLink?.album?d(Y):d(N,!1)})}f(h),a(I,h),fe(),G()}var Xe=P("<!> <!>",1),Ye=P('<!> <div class="flex flex-col gap-4 justify-between"><div class="flex flex-col"><!> <!> <!></div> <div class="flex flex-wrap items-center gap-2"></div></div>',1),Ze=P('<div class="flex w-full border-b border-gray-200 transition-all hover:border-immich-primary dark:border-gray-600 dark:text-immich-gray dark:hover:border-immich-dark-primary"><!> <div class="flex flex-auto flex-col place-content-center place-items-end text-end ms-4"><div class="sm:flex hidden"><!> <!> <!></div> <div class="sm:hidden"><!></div></div></div>');function et(I,t){me(t,!0);const p=()=>le(Be,"$locale",G),n=()=>le(ue,"$t",G),[G,c]=he();let T=ge.now(),h=i(()=>t.sharedLink.expiresAt?ge.fromISO(t.sharedLink.expiresAt):void 0),L=i(()=>e(h)?T>e(h):!1);const Y=(o,O)=>{const W=["days","hours","minutes","seconds"],J=o.diff(O,W).toObject();for(const m of W){const v=J[m];if(v&&v>0)return o.toRelativeCalendar({base:O,locale:p(),unit:m})}},N=i(()=>Ge(n(),t.sharedLink)),d=i(()=>e(N).Edit),R=i(()=>e(N).Copy),F=i(()=>e(N).Delete),q=i(()=>{const o=[];return t.sharedLink.allowUpload&&o.push(n()("upload")),t.sharedLink.allowDownload&&o.push(n()("download")),t.sharedLink.showMetadata&&o.push(n()("exif")),t.sharedLink.password&&o.push(n()("password")),o});var z=Ze(),u=y(z);Me(u,()=>e(L)?"div":"a",!1,(o,O)=>{Ue(o,_=>({href:_,class:"flex gap-4 w-full py-4"}),[()=>e(L)?void 0:ke.viewSharedLink(t.sharedLink)]);var W=Ye(),J=C(W);Ve(J,{class:"transition-all duration-300 hover:shadow-lg",get sharedLink(){return t.sharedLink}});var m=g(J,2),v=y(m),S=y(v);{let _=i(()=>e(L)?"danger":"muted");re(S,{size:"tiny",get color(){return e(_)},fontWeight:"medium",children:(Q,V)=>{var x=se(),X=C(x);{var te=r=>{var k=M();E(A=>U(k,A),[()=>n()("expired")]),a(r,k)},b=r=>{var k=se(),A=C(k);{var B=j=>{var ae=M();E(de=>U(ae,de),[()=>n()("expires_date",{values:{date:Y(e(h),T)}})]),a(j,ae)},ie=j=>{var ae=M();E(de=>U(ae,de),[()=>n()("expires_date",{values:{date:"∞"}})]),a(j,ae)};$(A,j=>{e(h)?j(B):j(ie,!1)},!0)}a(r,k)};$(X,r=>{e(L)?r(te):r(b,!1)})}a(Q,x)},$$slots:{default:!0}})}var K=g(S,2);re(K,{size:"large",color:"primary",class:"flex place-items-center gap-2 break-all",fontWeight:"medium",children:(_,Q)=>{var V=se(),x=C(V);{var X=b=>{var r=M();E(()=>U(r,t.sharedLink.album?.albumName)),a(b,r)},te=b=>{var r=se(),k=C(r);{var A=B=>{var ie=M();E(j=>U(ie,j),[()=>n()("individual_share")]),a(B,ie)};$(k,B=>{t.sharedLink.type===oe.Individual&&B(A)},!0)}a(b,r)};$(x,b=>{t.sharedLink.type===oe.Album?b(X):b(te,!1)})}a(_,V)},$$slots:{default:!0}});var ne=g(K,2);{var ye=_=>{re(_,{size:"small",class:"line-clamp-1",children:(Q,V)=>{ve();var x=M();E(()=>U(x,t.sharedLink.description)),a(Q,x)},$$slots:{default:!0}})};$(ne,_=>{t.sharedLink.description&&_(ye)})}f(v);var _e=g(v,2);be(_e,21,()=>e(q),Pe,(_,Q,V)=>{var x=Xe(),X=C(x);re(X,{size:"small",color:"primary",fontWeight:"medium",children:(r,k)=>{ve();var A=M();E(()=>U(A,e(Q))),a(r,A)},$$slots:{default:!0}});var te=g(X,2);{var b=r=>{re(r,{size:"small",color:"muted",children:(k,A)=>{ve();var B=M("•");a(k,B)},$$slots:{default:!0}})};$(te,r=>{V<e(q).length-1&&r(b)})}a(_,x)}),f(_e),f(m),a(O,W)});var D=g(u,2),s=y(D),l=y(s);ce(l,{get action(){return e(d)}});var w=g(l,2);ce(w,{get action(){return e(R)}});var Z=g(w,2);ce(Z,{get action(){return e(F)}}),f(s);var ee=g(s,2),H=y(ee);{let o=i(()=>n()("shared_link_options")),O=i(()=>[e(d),e(R),Ee.Divider,e(F)]);qe(H,{get"aria-label"(){return e(o)},position:"top-right",get items(){return e(O)}})}f(ee),f(D),f(z),a(I,z),fe(),c()}var tt=P('<div class="hidden xl:block h-10"><!></div>'),at=P('<div class="flex place-content-center place-items-center rounded-lg bg-gray-100 dark:bg-immich-dark-gray dark:text-immich-gray p-12"><p> </p></div>'),rt=P('<div class="flex flex-col gap-2"></div>'),st=P("<!> <!>",1),it=P("<!> <!>",1);function zt(I,t){me(t,!0);const p=()=>le(ue,"$t",n),[n,G]=he();let c=Ae(Ce([]));const T=async()=>{pe(c,await Fe({}),!0)};Se(async()=>{await T()});const h={all:p()("all"),album:p()("albums"),individual:p()("individual_shares")};let L=Object.keys(h),Y=Object.values(h);const N=s=>{const l=s.searchParams.get("filter");return l&&L.includes(l)?l:"all"};let d=i(()=>N(De.url)),R=i(()=>e(c).filter(({type:s})=>e(d)==="all"||s===oe.Album&&e(d)==="album"||s===oe.Individual&&e(d)==="individual"));const F=s=>{const l=e(c).findIndex(w=>w.id===s.id);l!==-1&&(e(c)[l]=s)},q=s=>{pe(c,e(c).filter(({id:l})=>l!==s.id),!0)};var z=it(),u=C(z);je(u,{onSharedLinkUpdate:F,onSharedLinkDelete:q});var D=g(u,2);Oe(D,{get title(){return t.data.meta.title},buttons:l=>{var w=tt(),Z=y(w);{let ee=i(()=>p()("show_shared_links"));He(Z,{get label(){return e(ee)},get filters(){return L},get labels(){return Y},get selected(){return e(d)},onSelect:H=>ze(ke.sharedLinks({filter:H}))})}f(w),a(l,w)},children:(l,w)=>{Je(l,{center:!0,size:"medium",children:(Z,ee)=>{var H=st(),o=C(H);{var O=m=>{var v=at(),S=y(v),K=y(S,!0);f(S),f(v),E(ne=>U(K,ne),[()=>p()("you_dont_have_any_shared_links")]),a(m,v)},W=m=>{var v=rt();be(v,21,()=>e(R),S=>S.id,(S,K)=>{et(S,{get sharedLink(){return e(K)}})}),f(v),a(m,v)};$(o,m=>{e(c).length===0?m(O):m(W,!1)})}var J=g(o,2);Te(J,()=>t.children??$e),a(Z,H)},$$slots:{default:!0}})},$$slots:{buttons:!0,default:!0}}),a(I,z),fe(),G()}export{zt as component,Tt as universal};
