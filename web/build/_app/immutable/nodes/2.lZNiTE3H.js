import{a as Z}from"../chunks/CJGyQpNN.js";import{d as tt,g as et,a as st,e as rt,c as at}from"../chunks/DxRnQWdm.js";import"../chunks/DsnmJJEf.js";import{p as I,$ as D,f as V,a as j,g as h,h as ot,ae as nt,c as A,s as R,r as k,t as O,j as $,u as T,T as it,b as lt}from"../chunks/D0CSSuTl.js";import{c as ct,a as S,f as z}from"../chunks/Bd1JH_Ov.js";import{s as dt}from"../chunks/CMI33r64.js";import{L as ft,F as pt,ad as ut,q as mt}from"../chunks/D-UYCH9y.js";import{s as C,a as G,d as L}from"../chunks/zonMEKN6.js";import{p as i}from"../chunks/CG4KAGH3.js";import{e as d,s as gt}from"../chunks/C8vxa4mj.js";import{i as yt}from"../chunks/D8NIUdeB.js";import{c as vt}from"../chunks/BVZhy_zG.js";import{d as ht}from"../chunks/tPj2J2UR.js";import{f as _t}from"../chunks/WQ1yKytR.js";import{$ as wt}from"../chunks/DWQ0JXRY.js";import{a as bt}from"../chunks/Cr9S0fVn.js";const Ft=(async({url:l,params:o,route:c})=>(await Z(l,{public:tt(c.id)}),{asset:await et(o)})),Ut=Object.freeze(Object.defineProperty({__proto__:null,load:Ft},Symbol.toStringTag,{value:"Module"}));var Dt=z('<div class="fixed inset-0 flex h-full w-full flex-col items-center justify-center bg-gray-100/90 text-immich-dark-gray dark:bg-immich-dark-bg/90 dark:text-immich-gray"><!> <div class="text-2xl"> </div></div>');function $t(l,o){I(o,!0);const c=()=>G(wt,"$t",f),[f,_]=C();let p=T(()=>at(i.route?.id)?i.params.albumId:void 0),w=T(()=>rt(i.route.id)),a=ot(null);const u=t=>{t.dataTransfer&&t.dataTransfer.types.includes("Files")&&$(a,t.target,!0)},n=t=>{h(a)===t.target&&$(a,null)},m=async t=>{$(a,null),await g(t.dataTransfer)},b=t=>{if(!vt(t))return g(t.clipboardData)},g=async t=>{if(!t)return;if(!F())return E(t.files);const e=[],s=[];for(const y of t.items){const v=y.webkitGetAsEntry();if(v){e.push(v);continue}const P=y.getAsFile();P&&s.push(P)}const r=await M(e);return E([...s,...r])},F=()=>typeof DataTransferItem.prototype.webkitGetAsEntry=="function",M=async t=>{const e=[];let s=[...t];for(;s.length>0;){const r=s.pop();U(r)?s=s.concat(await J(r)):q(r)&&e.push(await H(r))}return e},U=t=>!!t&&t.isDirectory,q=t=>!!t&&t.isFile,H=async t=>new Promise((e,s)=>{t.file(e,s)}),B=t=>new Promise((e,s)=>{t.readEntries(e,s)}),J=async t=>{const e=t.createReader(),s=[];let r;do r=await B(e),s.push(...r);while(r.length>0);return s},E=async t=>{if(!t)return;const e=Array.from(t);st.isSharedLink?ht.set({isDragging:!0,files:e}):await _t({files:e,albumId:h(p),isLockedAssets:h(w)})},K=t=>{t.preventDefault(),t.stopPropagation(),u(t)},N=t=>{t.preventDefault(),t.stopPropagation(),n(t)},Q=async t=>{t.preventDefault(),t.stopPropagation(),await m(t)},W=t=>{t.preventDefault(),t.stopPropagation()};var x=ct();d("paste",nt,b),d("dragenter",D.body,K),d("dragleave",D.body,N),d("drop",D.body,Q);var X=V(x);{var Y=t=>{var e=Dt(),s=A(e);ft(s,{variant:"icon",size:"giant",class:"m-16 animate-bounce"});var r=R(s,2),y=A(r,!0);k(r),k(e),O(v=>gt(y,v),[()=>c()("drop_files_to_upload")]),d("dragover",e,W),pt(3,e,()=>ut,()=>({duration:250})),S(t,e)};yt(X,t=>{h(a)&&t(Y)})}S(l,x),j(),_()}var At=z("<div><!></div> <!>",1);function qt(l,o){I(o,!0);const c=()=>G(p,"$showAssetViewer",f),[f,_]=C();let{isViewing:p,setAsset:w,gridScrollTarget:a}=bt;it(()=>{i.data.asset?w(i.data.asset):L(p,!1);const F=i.url.searchParams.get("at");L(a,{at:F})});var u=At(),n=V(u);let m;var b=A(n);dt(b,()=>o.children??lt),k(n);var g=R(n,2);$t(g,{}),O(()=>m=mt(n,1,"svelte-nskuw0",null,m,{"display-none":c()})),S(l,u),j(),_()}export{qt as component,Ut as universal};
