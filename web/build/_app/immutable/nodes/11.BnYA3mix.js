import{U as ot}from"../chunks/0qPXRVhz.js";import{r as Ie,R as V}from"../chunks/gegweU97.js";import{a as nt,r as lt}from"../chunks/CJGyQpNN.js";import{g as dt,$ as ut}from"../chunks/DWQ0JXRY.js";import{w as vt,$ as mt,a0 as ct,a1 as gt}from"../chunks/BP6NvnZ7.js";import"../chunks/DsnmJJEf.js";import{t as v,s as a,g as e,c as m,u as t,n as h,r as c,p as _t,h as $t,i as G,f as j,a as ft,j as pt,b as ht,aD as Pt}from"../chunks/D0CSSuTl.js";import{s as g}from"../chunks/C8vxa4mj.js";import{s as yt}from"../chunks/CMI33r64.js";import{i as K}from"../chunks/D8NIUdeB.js";import{e as xt}from"../chunks/DLePdI2u.js";import{t as P,a as o,f as C,c as bt}from"../chunks/Bd1JH_Ov.js";import{T as E,a as qe,W as Ut,w as At,aP as St,aQ as wt,aR as Ct,aU as Dt,aV as zt,aW as Bt,aX as kt,aY as It,s as Rt,q as Tt,ac as qt,K as Ot,ae as jt}from"../chunks/D-UYCH9y.js";import{s as Et,a as Re}from"../chunks/zonMEKN6.js";import{g as Ft}from"../chunks/gvLJu3l0.js";import{A as N}from"../chunks/BKrzsNSY.js";import{A as Lt}from"../chunks/CaRu5ymf.js";import{O as Mt}from"../chunks/Cq6696VF.js";import{S as le}from"../chunks/COjsYhP1.js";import{U as Wt}from"../chunks/CIJfCxLq.js";import{D as Ht}from"../chunks/DHPLL61V.js";import{g as Xt}from"../chunks/Rsfk-vdN.js";import{l as Gt,T as Te,u as Kt,U as Nt}from"../chunks/DUXNbmIP.js";import{C as Qt}from"../chunks/CG2BHJh0.js";import{C as Vt}from"../chunks/cX31cXxY.js";import{H as W,S as de}from"../chunks/Tw41aoDi.js";import{C as Yt}from"../chunks/DZu0po9D.js";import{g as Q}from"../chunks/D5MBkTLC.js";import{A as Jt}from"../chunks/B2XNhc0s.js";import{B as Zt}from"../chunks/DKzKigBY.js";const er=(async({params:F,url:U})=>{await nt(U,{admin:!0}),await lt(),ot.test(F.id)||Ie(307,V.users());const[$]=await vt({id:F.id,withDeleted:!0}).catch(()=>[]);$||Ie(307,V.users());const[r,L,O]=await Promise.all([mt({id:$.id}),ct({id:$.id}),gt({id:$.id})]),i=await dt();return{user:$,userPreferences:r,userStatistics:L,userSessions:O,meta:{title:i("admin.user_details")}}}),Hr=Object.freeze(Object.defineProperty({__proto__:null,load:er},Symbol.toStringTag,{value:"Module"}));var tr=C('<div class="flex justify-between items-center"><!> <!></div>');function I(F,U){var $=tr(),r=m($);E(r,{class:"text-sm",fontWeight:"medium",children:(O,i)=>{h();var A=P();v(()=>g(A,U.title)),o(O,A)},$$slots:{default:!0}});var L=a(r,2);{let O=t(()=>U.state?Ut:At),i=t(()=>U.state?"text-primary":"text-danger");qe(L,{get icon(){return e(O)},get class(){return e(i)},size:"24"})}c($),o(F,$)}var rr=C("<div><!></div>"),ar=C("<div><!> <!></div> <div><!> <!></div> <div><!> <!></div> <div><!> <!></div> <div><!> <!></div>",1),sr=C("<!> <!> <!> <!> <!> <!> <!> <!> <!>",1),ir=C("<!> ",1),or=C('<div class="storage-status p-4 mt-4 bg-gray-100 dark:bg-immich-dark-primary/10 rounded-lg text-sm w-full"><p class="font-medium text-immich-dark-gray dark:text-white mb-2"> </p> <div class="mt-4 h-1.75 w-full rounded-full bg-gray-200 dark:bg-gray-700"><div></div></div></div>'),nr=C("<!> <!>",1),lr=C('<span class="text-dark"> </span>'),dr=C('<!> <div class="grid gap-4 grid-cols-1 lg:grid-cols-2 w-full"><div class="col-span-full flex flex-col gap-4 my-4"><div class="flex items-center gap-4"><!> <!></div> <!></div> <div class="col-span-full"><div class="flex flex-col lg:flex-row gap-4 w-full"><!> <!> <!></div></div> <!> <!> <!> <!></div> <!>',1),ur=C("<div><!></div>"),vr=C("<!> <!> <!>",1);function Xr(F,U){_t(U,!0);const $=()=>Re(Gt,"$locale",L),r=()=>Re(ut,"$t",L),[L,O]=Et();let i=$t(G(U.data.user));const A=G(U.data.userPreferences),ue=G(U.data.userStatistics),Oe=G(U.data.userSessions),je=1024**4,ve=t(()=>e(i).quotaUsageInBytes??0);let Ee=t(()=>Kt(e(ve),e(ve)>je?2:0)),me=t(()=>Pt(e(Ee),2)),Fe=t(()=>e(me)[0]),Le=t(()=>e(me)[1]);const Y=t(()=>e(i).quotaUsageInBytes??0),J=t(()=>e(i).quotaSizeInBytes??1);let Z=t(()=>Math.min(Math.round(e(Y)/e(J)*100),100)),ce=t(()=>Nt($()).code),Me=t(()=>new Date(e(i).createdAt)),We=t(()=>new Date(e(i).updatedAt)),He=t(()=>Te(e(ce)).formatDateTime(e(Me))),Xe=t(()=>Te(e(ce)).formatDateTime(e(We)));const Ge=()=>e(Z)>=95?"bg-red-500":e(Z)>80?"bg-yellow-500":"bg-primary",H=t(()=>Xt(r(),e(i))),ge=t(()=>e(H).ResetPassword),_e=t(()=>e(H).ResetPinCode),$e=t(()=>e(H).Update),fe=t(()=>e(H).Delete),pe=t(()=>e(H).Restore),ee=R=>{R.id===e(i).id&&pt(i,R,!0)},Ke=async({id:R})=>{R===e(i).id&&await Ft(V.users())};var he=vr(),Pe=j(he);Mt(Pe,{onUserAdminUpdate:ee,onUserAdminDelete:ee,onUserAdminRestore:ee,onUserAdminDeleted:Ke});var ye=a(Pe,2);{let R=t(()=>r()("user")),te=t(()=>[e(ge),e(_e),e($e),e(fe),e(pe)]);Qt(ye,{get name(){return e(R)},get actions(){return e(te)}})}var Ne=a(ye,2);{let R=t(()=>[{title:r()("admin.user_management"),href:V.users()},{title:e(i).name}]),te=t(()=>[e(ge),e(_e),e($e),e(pe),jt.Divider,e(fe)]);Lt(Ne,{get breadcrumbs(){return e(R)},get actions(){return e(te)},children:(Qe,mr)=>{var re=ur(),Ve=m(re);Vt(Ve,{size:"large",center:!0,children:(Ye,cr)=>{var xe=dr(),be=j(xe);{var Je=l=>{{let f=t(()=>r()("user_has_been_deleted"));Jt(l,{color:"danger",class:"my-4",get title(){return e(f)},get icon(){return Ot}})}};K(be,l=>{e(i).deletedAt&&l(Je)})}var ae=a(be,2),se=m(ae),ie=m(se),Ue=m(ie);Wt(Ue,{get user(){return e(i)},size:"md"});var Ze=a(Ue,2);W(Ze,{tag:"h1",size:"large",children:(l,f)=>{h();var T=P();v(()=>g(T,e(i).name)),o(l,T)},$$slots:{default:!0}}),c(ie);var et=a(ie,2);{var tt=l=>{var f=rr(),T=m(f);Zt(T,{color:"primary",size:"small",children:(D,M)=>{h();var y=P();v(S=>g(y,S),[()=>r()("admin.admin_user")]),o(D,y)},$$slots:{default:!0}}),c(f),o(l,f)};K(et,l=>{e(i).isAdmin&&l(tt)})}c(se);var oe=a(se,2),Ae=m(oe),Se=m(Ae);{let l=t(()=>r()("photos"));le(Se,{get icon(){return St},get title(){return e(l)},get value(){return ue.images}})}var we=a(Se,2);{let l=t(()=>r()("videos"));le(we,{get icon(){return wt},get title(){return e(l)},get value(){return ue.videos}})}var rt=a(we,2);{let l=t(()=>r()("storage"));le(rt,{get icon(){return Ct},get title(){return e(l)},get value(){return e(Fe)},get unit(){return e(Le)}})}c(Ae),c(oe);var Ce=a(oe,2);{let l=t(()=>r()("profile"));N(Ce,{get icon(){return Dt},get title(){return e(l)},children:(f,T)=>{de(f,{gap:2,children:(D,M)=>{var y=ar(),S=j(y),x=m(S);W(x,{tag:"h3",size:"tiny",children:(u,B)=>{h();var s=P();v(k=>g(s,k),[()=>r()("name")]),o(u,s)},$$slots:{default:!0}});var w=a(x,2);E(w,{children:(u,B)=>{h();var s=P();v(()=>g(s,e(i).name)),o(u,s)},$$slots:{default:!0}}),c(S);var d=a(S,2),_=m(d);W(_,{tag:"h3",size:"tiny",children:(u,B)=>{h();var s=P();v(k=>g(s,k),[()=>r()("email")]),o(u,s)},$$slots:{default:!0}});var z=a(_,2);E(z,{children:(u,B)=>{h();var s=P();v(()=>g(s,e(i).email)),o(u,s)},$$slots:{default:!0}}),c(d);var p=a(d,2),b=m(p);W(b,{tag:"h3",size:"tiny",children:(u,B)=>{h();var s=P();v(k=>g(s,k),[()=>r()("created_at")]),o(u,s)},$$slots:{default:!0}});var q=a(b,2);E(q,{children:(u,B)=>{h();var s=P();v(()=>g(s,e(He))),o(u,s)},$$slots:{default:!0}}),c(p);var n=a(p,2),X=m(n);W(X,{tag:"h3",size:"tiny",children:(u,B)=>{h();var s=P();v(k=>g(s,k),[()=>r()("updated_at")]),o(u,s)},$$slots:{default:!0}});var ne=a(X,2);E(ne,{children:(u,B)=>{h();var s=P();v(()=>g(s,e(Xe))),o(u,s)},$$slots:{default:!0}}),c(n);var Be=a(n,2),ke=m(Be);W(ke,{tag:"h3",size:"tiny",children:(u,B)=>{h();var s=P();v(k=>g(s,k),[()=>r()("id")]),o(u,s)},$$slots:{default:!0}});var it=a(ke,2);Yt(it,{children:(u,B)=>{h();var s=P();v(()=>g(s,e(i).id)),o(u,s)},$$slots:{default:!0}}),c(Be),o(D,y)},$$slots:{default:!0}})}})}var De=a(Ce,2);{let l=t(()=>r()("features"));N(De,{get icon(){return zt},get title(){return e(l)},children:(f,T)=>{de(f,{gap:3,children:(D,M)=>{var y=sr(),S=j(y);{let n=t(()=>r()("email_notifications"));I(S,{get title(){return e(n)},get state(){return A.emailNotifications.enabled}})}var x=a(S,2);{let n=t(()=>r()("folders"));I(x,{get title(){return e(n)},get state(){return A.folders.enabled}})}var w=a(x,2);{let n=t(()=>r()("memories"));I(w,{get title(){return e(n)},get state(){return A.memories.enabled}})}var d=a(w,2);{let n=t(()=>r()("people"));I(d,{get title(){return e(n)},get state(){return A.people.enabled}})}var _=a(d,2);{let n=t(()=>r()("rating"));I(_,{get title(){return e(n)},get state(){return A.ratings.enabled}})}var z=a(_,2);{let n=t(()=>r()("shared_links"));I(z,{get title(){return e(n)},get state(){return A.sharedLinks.enabled}})}var p=a(z,2);{let n=t(()=>r()("show_supporter_badge"));I(p,{get title(){return e(n)},get state(){return A.purchase.showSupportBadge}})}var b=a(p,2);{let n=t(()=>r()("tags"));I(b,{get title(){return e(n)},get state(){return A.tags.enabled}})}var q=a(b,2);{let n=t(()=>r()("gcast_enabled"));I(q,{get title(){return e(n)},get state(){return A.cast.gCastEnabled}})}o(D,y)},$$slots:{default:!0}})}})}var ze=a(De,2);{let l=t(()=>r()("storage_quota"));N(ze,{get icon(){return Bt},get title(){return e(l)},children:(f,T)=>{var D=nr(),M=j(D);{var y=d=>{E(d,{children:(_,z)=>{h();var p=P();v(b=>g(p,b),[()=>r()("storage_usage",{values:{used:Q(e(Y),$(),3),available:Q(e(J),$(),3)}})]),o(_,p)},$$slots:{default:!0}})},S=d=>{E(d,{class:"flex items-center gap-1",children:(_,z)=>{var p=ir(),b=j(p);qe(b,{get icon(){return It},size:"1.25rem",class:"text-success"});var q=a(b);v(n=>g(q,` ${n??""}`),[()=>r()("unlimited")]),o(_,p)},$$slots:{default:!0}})};K(M,d=>{e(i).quotaSizeInBytes!==null&&e(i).quotaSizeInBytes>=0?d(y):d(S,!1)})}var x=a(M,2);{var w=d=>{var _=or(),z=m(_),p=m(z,!0);c(z);var b=a(z,2),q=m(b);c(b),c(_),v((n,X,ne)=>{Rt(_,"title",n),g(p,X),Tt(q,1,`h-1.75 rounded-full ${ne??""}`),qt(q,`width: ${e(Z)??""}%`)},[()=>r()("storage_usage",{values:{used:Q(e(Y),$(),3),available:Q(e(J),$(),3)}}),()=>r()("storage"),Ge]),o(d,_)};K(x,d=>{e(i).quotaSizeInBytes!==null&&e(i).quotaSizeInBytes>=0&&d(w)})}o(f,D)}})}var at=a(ze,2);{let l=t(()=>r()("authorized_devices"));N(at,{get icon(){return kt},get title(){return e(l)},children:(f,T)=>{de(f,{gap:3,children:(D,M)=>{var y=bt(),S=j(y);xt(S,17,()=>Oe,x=>x.id,(x,w)=>{Ht(x,{get session(){return e(w)}})},x=>{var w=lr(),d=m(w,!0);c(w),v(_=>g(d,_),[()=>r()("no_devices")]),o(x,w)}),o(D,y)},$$slots:{default:!0}})}})}c(ae);var st=a(ae,2);yt(st,()=>U.children??ht),o(Ye,xe)},$$slots:{default:!0}}),c(re),o(Qe,re)},$$slots:{default:!0}})}o(F,he),ft(),O()}export{Xr as component,Hr as universal};
