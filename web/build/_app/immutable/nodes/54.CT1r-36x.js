import{a as se}from"../chunks/CJGyQpNN.js";import{g as re,$ as oe}from"../chunks/DWQ0JXRY.js";import{aK as Ft}from"../chunks/BP6NvnZ7.js";import"../chunks/DsnmJJEf.js";import{s as l,o as ie}from"../chunks/C8vxa4mj.js";import{p as vt,c as s,r,t as v,g as t,a as ut,u as p,aD as At,f as z,s as e,n as c,h as le,i as ne,j as de}from"../chunks/D0CSSuTl.js";import{A as ve}from"../chunks/CaRu5ymf.js";import{a as i,f as b,t as f,c as ue}from"../chunks/Bd1JH_Ov.js";import{i as qt}from"../chunks/D8NIUdeB.js";import{e as ce}from"../chunks/DLePdI2u.js";import{p as me,s as _e,a as Lt}from"../chunks/zonMEKN6.js";import{S as nt}from"../chunks/COjsYhP1.js";import{l as fe,u as pe}from"../chunks/DUXNbmIP.js";import{T as H,aP as Ut,aQ as jt,aR as kt,a as dt}from"../chunks/D-UYCH9y.js";import{C as ge}from"../chunks/DZu0po9D.js";import{T as $e,a as xe,b as R,c as he,d as ye,e as K}from"../chunks/B5_uSbnk.js";import{a as be}from"../chunks/D5MBkTLC.js";import{C as Pe}from"../chunks/cX31cXxY.js";var we=b("<span> </span>");function N(B,n){vt(n,!0);const d=me(n,"variant",3,"short"),I=p(()=>be(n.bytes,n.precision)),y=p(()=>At(t(I),2)),j=p(()=>t(y)[0]),C=p(()=>t(y)[1]),k=p(()=>d()==="narrow"?"":" ");var W=we(),M=s(W);r(W),v(()=>l(M,`${t(j)??""}${t(k)??""}${t(C)??""}`)),i(B,W),ut()}const Se=(async({url:B})=>{await se(B,{admin:!0});const n=await Ft(),d=await re();return{stats:n,meta:{title:d("server_stats")}}}),Ze=Object.freeze(Object.defineProperty({__proto__:null,load:Se},Symbol.toStringTag,{value:"Module"}));var ze=b("<!> <!> <!> <!>",1),Be=b(" <!>)",1),Ie=b(" <!>)",1),Te=b("/ <!>",1),Ce=b('<!> <!> <span class="text-primary"><!></span>',1),We=b("<!> <!> <!> <!>",1),qe=b("<!> <!>",1),Le=b('<div class="flex flex-col gap-5 my-4"><div><!> <div class="hidden justify-between lg:flex gap-4"><!> <!> <!></div> <div class="mt-5 flex lg:hidden"><div class="flex flex-col justify-between rounded-3xl bg-subtle p-5 dark:bg-immich-dark-gray"><div class="flex flex-wrap gap-x-12"><div class="flex flex-1 place-items-center gap-4 text-primary"><!> <!></div> <div class="relative text-center font-mono text-2xl font-medium"><span class="text-light-300"> </span><span class="text-primary"> </span></div></div> <div class="flex flex-wrap gap-x-12"><div class="flex flex-1 place-items-center gap-4 text-primary"><!> <!></div> <div class="relative text-center font-mono text-2xl font-medium"><span class="text-light-300"> </span><span class="text-primary"> </span></div></div> <div class="flex flex-wrap gap-x-5"><div class="flex flex-1 flex-nowrap place-items-center gap-4 text-primary"><!> <!></div> <div class="relative flex text-center font-mono text-2xl font-medium"><span class="text-light-300"> </span><span class="text-primary"> </span> <div class="absolute -end-1.5 -bottom-4"><!></div></div></div></div></div></div> <div><!> <!></div></div>');function Ue(B,n){vt(n,!0);const d=()=>Lt(oe,"$t",y),I=()=>Lt(fe,"$locale",y),[y,j]=_e(),C=(o,$=13)=>{const a=o.toString().length,m=$-a;return"0".repeat(m)},k=1024**4;let W=p(()=>pe(n.stats.usage,n.stats.usage>k?2:0)),M=p(()=>At(t(W),2)),Q=p(()=>t(M)[0]),ct=p(()=>t(M)[1]);var V=Le(),E=s(V),mt=s(E);H(mt,{class:"mb-2",fontWeight:"medium",children:(o,$)=>{c();var a=f();v(m=>l(a,m),[()=>d()("total_usage")]),i(o,a)},$$slots:{default:!0}});var G=e(mt,2),_t=s(G);{let o=p(()=>d()("photos"));nt(_t,{get icon(){return Ut},get title(){return t(o)},get value(){return n.stats.photos}})}var ft=e(_t,2);{let o=p(()=>d()("videos"));nt(ft,{get icon(){return jt},get title(){return t(o)},get value(){return n.stats.videos}})}var Dt=e(ft,2);{let o=p(()=>d()("storage"));nt(Dt,{get icon(){return kt},get title(){return t(o)},get value(){return t(Q)},get unit(){return t(ct)}})}r(G);var pt=e(G,2),gt=s(pt),J=s(gt),X=s(J),$t=s(X);dt($t,{get icon(){return Ut},size:"25"});var Ht=e($t,2);H(Ht,{size:"medium",fontWeight:"medium",children:(o,$)=>{c();var a=f();v(m=>l(a,m),[()=>d()("photos")]),i(o,a)},$$slots:{default:!0}}),r(X);var xt=e(X,2),Y=s(xt),Mt=s(Y,!0);r(Y);var ht=e(Y),Ot=s(ht,!0);r(ht),r(xt),r(J);var Z=e(J,2),tt=s(Z),yt=s(tt);dt(yt,{get icon(){return jt},size:"25"});var Rt=e(yt,2);H(Rt,{size:"medium",fontWeight:"medium",children:(o,$)=>{c();var a=f();v(m=>l(a,m),[()=>d()("videos")]),i(o,a)},$$slots:{default:!0}}),r(tt);var bt=e(tt,2),et=s(bt),Kt=s(et,!0);r(et);var Pt=e(et),Nt=s(Pt,!0);r(Pt),r(bt),r(Z);var wt=e(Z,2),at=s(wt),St=s(at);dt(St,{get icon(){return kt},size:"25"});var Qt=e(St,2);H(Qt,{size:"medium",fontWeight:"medium",children:(o,$)=>{c();var a=f();v(m=>l(a,m),[()=>d()("storage")]),i(o,a)},$$slots:{default:!0}}),r(at);var zt=e(at,2),st=s(zt),Vt=s(st,!0);r(st);var rt=e(st),Et=s(rt,!0);r(rt);var Bt=e(rt,2),Gt=s(Bt);ge(Gt,{color:"muted",class:"text-xs font-light font-mono",children:(o,$)=>{c();var a=f();v(()=>l(a,t(ct))),i(o,a)},$$slots:{default:!0}}),r(Bt),r(zt),r(wt),r(gt),r(pt),r(E);var It=e(E,2),Tt=s(It);H(Tt,{class:"mb-2 mt-4",fontWeight:"medium",children:(o,$)=>{c();var a=f();v(m=>l(a,m),[()=>d()("user_usage_detail")]),i(o,a)},$$slots:{default:!0}});var Jt=e(Tt,2);$e(Jt,{striped:!0,size:"small",children:(o,$)=>{var a=qe(),m=z(a);xe(m,{children:(ot,Yt)=>{var F=ze(),O=z(F);R(O,{class:"w-1/4",children:(P,L)=>{c();var _=f();v(x=>l(_,x),[()=>d()("user")]),i(P,_)},$$slots:{default:!0}});var q=e(O,2);R(q,{class:"w-1/4",children:(P,L)=>{c();var _=f();v(x=>l(_,x),[()=>d()("photos")]),i(P,_)},$$slots:{default:!0}});var u=e(q,2);R(u,{class:"w-1/4",children:(P,L)=>{c();var _=f();v(x=>l(_,x),[()=>d()("videos")]),i(P,_)},$$slots:{default:!0}});var it=e(u,2);R(it,{class:"w-1/4",children:(P,L)=>{c();var _=f();v(x=>l(_,x),[()=>d()("usage")]),i(P,_)},$$slots:{default:!0}}),i(ot,F)},$$slots:{default:!0}});var Xt=e(m,2);he(Xt,{class:"block max-h-80 overflow-y-auto",children:(ot,Yt)=>{var F=ue(),O=z(F);ce(O,17,()=>n.stats.usageByUser,q=>q.userId,(q,u)=>{ye(q,{children:(it,P)=>{var L=We(),_=z(L);K(_,{class:"w-1/4",children:(T,lt)=>{c();var g=f();v(()=>l(g,t(u).userName)),i(T,g)},$$slots:{default:!0}});var x=e(_,2);K(x,{class:"w-1/4",children:(T,lt)=>{c();var g=Be(),w=z(g),U=e(w);N(U,{get bytes(){return t(u).usagePhotos}}),c(),v(A=>l(w,`${A??""} (`),[()=>t(u).photos.toLocaleString(I())]),i(T,g)},$$slots:{default:!0}});var Ct=e(x,2);K(Ct,{class:"w-1/4",children:(T,lt)=>{c();var g=Ie(),w=z(g),U=e(w);N(U,{get bytes(){return t(u).usageVideos},precision:0}),c(),v(A=>l(w,`${A??""} (`),[()=>t(u).videos.toLocaleString(I())]),i(T,g)},$$slots:{default:!0}});var Zt=e(Ct,2);K(Zt,{class:"w-1/4",children:(T,lt)=>{var g=Ce(),w=z(g);N(w,{get bytes(){return t(u).usage},precision:0});var U=e(w,2);{var A=h=>{var S=Te(),D=e(z(S));N(D,{get bytes(){return t(u).quotaSizeInBytes},precision:0}),i(h,S)};qt(U,h=>{t(u).quotaSizeInBytes!==null&&h(A)})}var Wt=e(U,2),te=s(Wt);{var ee=h=>{var S=f();v(D=>l(S,`(${D??""})`),[()=>(t(u).quotaSizeInBytes===0?1:t(u).usage/t(u).quotaSizeInBytes).toLocaleString(I(),{style:"percent",maximumFractionDigits:0})]),i(h,S)},ae=h=>{var S=f();v(D=>l(S,`(${D??""})`),[()=>d()("unlimited")]),i(h,S)};qt(te,h=>{t(u).quotaSizeInBytes!==null&&t(u).quotaSizeInBytes>=0?h(ee):h(ae,!1)})}r(Wt),i(T,g)},$$slots:{default:!0}}),i(it,L)},$$slots:{default:!0}})}),i(ot,F)},$$slots:{default:!0}}),i(o,a)},$$slots:{default:!0}}),r(It),r(V),v((o,$,a)=>{l(Mt,o),l(Ot,n.stats.photos),l(Kt,$),l(Nt,n.stats.videos),l(Vt,a),l(Et,t(Q))},[()=>C(n.stats.photos),()=>C(n.stats.videos),()=>C(t(Q))]),i(B,V),ut(),j()}function ta(B,n){vt(n,!0);let d=le(ne(n.data.stats));const I=async()=>{de(d,await Ft(),!0)};ie(()=>{const y=setInterval(()=>{I()},5e3);return()=>clearInterval(y)});{let y=p(()=>[{title:n.data.meta.title}]);ve(B,{get breadcrumbs(){return t(y)},children:(j,C)=>{Pe(j,{size:"large",center:!0,children:(k,W)=>{Ue(k,{get stats(){return t(d)}})},$$slots:{default:!0}})},$$slots:{default:!0}})}ut()}export{ta as component,Ze as universal};
